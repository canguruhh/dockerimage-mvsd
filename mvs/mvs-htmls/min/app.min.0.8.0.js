"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){function e(e,s){e.state("login",{url:"/login",templateUrl:"login/login.view.0.8.0.html",controller:"LoginController",controllerAs:"vm"}).state("register",{url:"/register",templateUrl:"register/register.view.0.8.0.html",controller:"RegisterController",controllerAs:"vm"}).state("home",{abstract:!0,templateUrl:"home/index.view.0.8.0.html",controller:"HomeController",controllerAs:"vm"}).state("home.account",{abstract:!0,templateUrl:"home/account/index.view.0.8.0.html",controller:"AccountController",controllerAs:"vm"}).state("home.account.details",{url:"/account/details",templateUrl:"home/account/details.view.0.8.0.html",controller:"AccountController",controllerAs:"vm"}).state("home.account.privatekey",{url:"/account/privatekey",templateUrl:"home/account/privatekey.view.0.8.0.html",controller:"AccountController",controllerAs:"vm"}).state("home.account.export",{url:"/account/export",templateUrl:"home/account/export.view.0.8.0.html",controller:"AccountController",controllerAs:"vm"}).state("home.addresses",{templateUrl:"home/addresses/index.view.0.8.0.html",controller:"AddressesController"}).state("home.addresses.myaddresses",{url:"/addresses/myaddresses",templateUrl:"home/addresses/myaddresses.view.0.8.0.html",controller:"AddressesController",controllerAs:"vm"}).state("home.home",{url:"/home",templateUrl:"home/home.view.0.8.0.html",controller:"AssetsController",controllerAs:"vm"}).state("home.explorer",{templateUrl:"home/explorer/index.view.0.8.0.html",controller:"ExplorerController"}).state("home.explorer.search",{url:"/explorer/search/:search",templateUrl:"home/explorer/search.view.0.8.0.html",controller:"ExplorerController"}).state("home.explorer.transaction",{url:"/explorer/tx/:hash",templateUrl:"home/explorer/transaction.view.0.8.0.html",controller:"ExplorerController"}).state("home.explorer.address",{url:"/explorer/adr/:address",templateUrl:"home/explorer/address.view.0.8.0.html",controller:"ExplorerController"}).state("home.explorer.block",{url:"/explorer/blk/:block",templateUrl:"home/explorer/block.view.0.8.0.html",controller:"ExplorerController"}).state("home.explorer.noresult",{url:"/explorer/noresult/:search",templateUrl:"home/explorer/noresult.view.0.8.0.html",controller:"ExplorerController"}).state("home.asset",{abstract:!0,templateUrl:"home/assets/index.view.0.8.0.html"}).state("home.asset.alldetails",{url:"/asset/all",templateUrl:"home/assets/all.view.0.8.0.html",controller:"ShowAllAssetsController",controllerAs:"vm"}).state("home.asset.myassets",{url:"/asset/myassets",templateUrl:"home/assets/myassets.view.0.8.0.html",controller:"ShowAssetsController",controllerAs:"vm"}).state("home.asset.mymits",{url:"/asset/mymits",templateUrl:"home/assets/mymits.view.0.8.0.html",controller:"ShowMITsController",controllerAs:"vm"}).state("home.asset.details",{url:"/asset/details/:symbol",templateUrl:"home/assets/details.view.0.8.0.html",controller:"AssetDetailController",controllerAs:"vm"}).state("home.asset.secondaryissue",{url:"/asset/secondaryissue/:symbol",templateUrl:"home/assets/secondaryissue.view.0.8.0.html",controller:"AssetSecondaryIssueController",controllerAs:"vm"}).state("home.asset.create",{url:"/asset/create",templateUrl:"home/assets/create.view.0.8.0.html",controller:"CreateAssetController",controllerAs:"vm"}).state("home.asset.createmit",{url:"/asset/createmit",templateUrl:"home/assets/createmit.view.0.8.0.html",controller:"CreateMITController",controllerAs:"vm"}).state("home.transferasset",{url:"/transfer/asset/:symbol",templateUrl:"home/transfer/transferasset.view.0.8.0.html",controller:"TransferAssetController",controllerAs:"vm"}).state("home.transferetp",{url:"/transfer/ETP",templateUrl:"home/transfer/transferetp.view.0.8.0.html",controller:"ETPController",controllerAs:"vm"}).state("home.transfermit",{url:"/transfer/mit/:symbol",templateUrl:"home/transfer/transfermit.view.0.8.0.html",controller:"TransferMITController",controllerAs:"vm"}).state("home.multisignature",{url:"/transfer/multisignature/:symbol",templateUrl:"home/transfer/multisignature.view.0.8.0.html",controller:"TransferMultiSignController",controllerAs:"vm"}).state("home.sign",{url:"/transfer/sign/:symbol",templateUrl:"home/transfer/sign.view.0.8.0.html",controller:"SignMultiSignController",controllerAs:"vm"}).state("home.createmultisignature",{url:"/addresses/newmultisignature",templateUrl:"home/addresses/createmultisignature.view.0.8.0.html",controller:"NewMultiSignController",controllerAs:"vm"}).state("home.deposit",{url:"/deposit/:symbol",templateUrl:"home/deposit.view.0.8.0.html",controller:"DepositController",controllerAs:"vm"}).state("home.console",{url:"/advanced",templateUrl:"home/console.view.0.8.0.html",controller:"ConsoleController"}).state("home.profile",{templateUrl:"home/avatar/index.view.0.8.0.html",controller:"ProfileController"}).state("home.profile.myprofile",{url:"/avatar/myavatars/:avatar",templateUrl:"home/avatar/myavatars.view.0.8.0.html",controller:"ProfileController"}).state("home.profile.create",{url:"/avatar/create",templateUrl:"home/avatar/create.view.0.8.0.html",controller:"CreateProfileController"}).state("home.profile.all",{url:"/avatar/all",templateUrl:"home/avatar/all.view.0.8.0.html",controller:"AllProfilesController"}).state("home.profile.modifyaddress",{url:"/avatar/modifyaddress/:didsymbol",templateUrl:"home/avatar/modifyaddress.view.0.8.0.html",controller:"ModifyAddressController"}).state("home.profile.transfercert",{url:"/avatar/transfercert/:symboltype",templateUrl:"home/avatar/transfercert.view.0.8.0.html",controller:"TransferCertController"}).state("home.profile.issuecert",{url:"/avatar/issuecert/:symbol",templateUrl:"home/avatar/issuecert.view.0.8.0.html",controller:"IssueCertController"}),s.otherwise("/login")}function s(e,a,o,s){null!=o.get("language")&&s.use(o.get("language")),e.$on("$locationChangeStart",function(e,s,t){var r=-1===["/login","/register"].indexOf(a.path()),n=null!=o.get("credentials");r&&!n&&a.path("/login")})}angular.module("app",["ui.router","ngCookies","LocalStorageModule","pascalprecht.translate","angularUtils.directives.dirPagination","ngDialog","ngFileSaver"]).config(e).filter("assetformat",function(){return function(e,s){return void 0===s&&(s=8),bigDecimal.getPrettyValue(bigDecimal.divide(e,Math.pow(10,s),parseInt(s)))}}).config(["$compileProvider",function(e){}]).config(["localStorageServiceProvider",function(e){e.setPrefix("mvs.live")}]).config(["$translateProvider",function(e){e.useStaticFilesLoader({prefix:"lang/",suffix:".0.8.0.json"}),e.registerAvailableLanguageKeys(["en","de","zh"],{"en-US":"en","en-UK":"en","de-DE":"de","zh-ZH":"zh"}),e.useSanitizeValueStrategy("escapeParameters"),e.preferredLanguage("zh_ZH")}]).constant("appName","Metaverse").run(s),e.$inject=["$stateProvider","$urlRouterProvider"],s.$inject=["$rootScope","$location","localStorageService","$translate","FileSaver","Blob"]}(),function(){function e(n){var e={Success:function(e,s,t,r){n.flash={message:e,type:"success",keepAfterLocationChange:s,hash:t,link:r}},Error:function(e,s,t,r){n.flash={message:e,type:"error",keepAfterLocationChange:s,hash:t,link:r}},Info:function(e,s,t,r){n.flash={message:e,type:"info",keepAfterLocationChange:s,hash:t,link:r}},Warning:function(e,s,t,r){n.flash={message:e,type:"warning",keepAfterLocationChange:s,hash:t,link:r}},CloseFlashMessage:function(){delete n.flash}};return n.$on("$locationChangeStart",function(){var e;(e=n.flash)&&(e.keepAfterLocationChange?e.keepAfterLocationChange=!1:delete n.flash)}),e}angular.module("app").factory("FlashService",e),e.$inject=["$rootScope"]}(),function(){function e(e,s){function r(){s.selectedMenu={main:e.path().split("/")[1]}}r(),s.$on("$locationChangeStart",function(e,s,t){r()})}function s(r,e,t,s,n,a,o,l,c,i){var d,u;function m(e,s){for(var t=e;t<s&&!a.stopLoad;t++)NProgress.start(),r.ListTxsAddress(a.search,t).then(function(e){void 0!==e.success&&e.success&&null!=e.data?(e.data.total_page!=e.data.current_page||isNaN(e.data.total_page)||(a.stopLoad=!0),e.data.transactions.forEach(function(e){var s={height:e.height,hash:e.hash,timestamp:new Date(1e3*e.timestamp)};a.transactionsAddressSearch.push(s),a.exists=!0})):c("MESSAGES.NO_LISTED_TRANSACTIONS").then(function(e){o.Error(e),a.noResult=!0}),NProgress.done()})}i.scrollTo(0,0),a.typeSearch=t.path().split("/")[2],a.search=t.path().split("/")[3],a.transactionsAddressSearch=[],a.searchAddressloadTransactions=m,a.searchAddressloadMore=function(){a.stopLoad||(a.page=a.page+1,m(a.page-1,a.page))},a.page=2,a.stopLoad=!1,a.showqr=function(e){angular.element(document).ready(function(){new QRCode(document.getElementById("qrcode"),{text:e,width:200,height:200,colorDark:"#000000",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.H})})},a.transaction_count=0,a.assets=[],a.exists=!1,a.noResult=!1,a.transactionInputsValues=[],(a.asset="")==a.typeSearch||"noresult"==a.typeSearch||"search"==a.typeSearch||("tx"===a.typeSearch?void 0!==(u=a.search)&&(NProgress.start(),r.FetchTx(u).then(function(e){if(void 0===e||void 0===e.success||0==e.success)c("MESSAGES.TRANSACTION_NOT_FOUND").then(function(e){o.Error(e)}),a.noResult=!0,i.scrollTo(0,0);else{a.transaction=e.data.transaction;var s=a.exists=!0;a.transaction.inputs.forEach(function(e){e.display=!1,s?(e.first=!0,s=!1):e.first=!1}),a.transaction.outputs.forEach(function(e){var s;e.display=!1,"asset-transfer"!=e.attachment.type&&"asset-issue"!=e.attachment.type||(s=e.attachment.symbol,r.GetAsset(s).then(function(e){NProgress.done(),void 0!==e.success&&e.success?a.asset=e.data.assets[0]:c("MESSAGES.ASSETS_LOAD_ERROR").then(function(e){return o.Error(e)})}))}),a.transactionInputsValues=[]}NProgress.done()})):"adr"===a.typeSearch?void 0!==a.search&&m(1,2):"blk"===a.typeSearch?(d=a.search,a.blockInfos=[],void 0!==d&&(NProgress.start(),r.FetchHeader(d).then(function(e){var s;void 0===e||void 0===e.success||0==e.success?(a.noResult=!0,c("MESSAGES.BLOCK_NOT_FOUND").then(function(e){o.Error(e)}),i.scrollTo(0,0)):(s=e.data.result.hash,a.transactionsPerBlock=[],r.GetBlock(s).then(function(e){void 0===e||void 0===e.success||0==e.success?c("MESSAGES.TRANSACTION_NOT_FOUND").then(function(e){o.Error(e),t.path("/explorer")}):e.data.txs.transactions.forEach(function(e){a.transaction_count++;var s={hash:e.hash};a.transactionsPerBlock.push(s)}),NProgress.done()}),a.exists=!0,a.blockInfos={hash:e.data.result.hash,timestamp:new Date(1e3*e.data.result.time_stamp),nonce:e.data.result.nonce,mixhash:e.data.result.mixhash,version:e.data.result.version,merkle_tree_hash:e.data.result.merkle_tree_hash,previous_block_hash:e.data.result.previous_block_hash}),NProgress.done()}))):t.path("/explorer"))}function t(l,s,t,c,i,d,u,m,e,f){function h(){c.deposit_address="",c.password="",c.value="",c.transactionFee=1e-4,c.confirmation=!1,c.period_select="",c.submittable=!1}function r(){for(var e in c.error)if(c.error[e])return void(c.submittable=!1);c.address_option&&c.option.deposit_address_incorrect?c.submittable=!1:c.submittable=!0}m.scrollTo(0,0),c.symbol=f("uppercase")(e.path().split("/")[2]),c.deposit=function(e,s,t,r){var n=f("convertfortx")(e,c.decimal_number),a=f("convertfortx")(s,c.decimal_number);if(r!=d.get("credentials").password)u("MESSAGES.WRONG_PASSWORD").then(function(e){return i.Error(e)}),m.scrollTo(0,0);else{var o="ETP"==c.symbol?l.Deposit(c.deposit_options[t][2],n,a,r,c.address_option?c.deposit_address:void 0):l.FrozenAsset(c.deposit_options[t][2],n,a,r,c.symbol,c.address_option?c.deposit_address:void 0);o.then(function(s){NProgress.done(),void 0!==s.success&&s.success?(u("MESSAGES.DEPOSIT_SUCCESS").then(function(e){return i.Success(e,!1,s.data.result.transaction.hash)}),m.scrollTo(0,0),h()):(u("MESSAGES.DEPOSIT_ERROR").then(function(e){null!=s.message.message?i.Error(e+" "+s.message.message):i.Error(e)}),m.scrollTo(0,0),c.password="")})}},c.assetsIssued=[],c.balance=[],c.availableBalance=0,c.sendAll=function(){c.value=(c.availableBalance-1e8*c.transactionFee)/1e8},c.error=[],c.option=[],c.confirmation=!1,c.checkInputs=function(){c.confirmation=!0,delete t.flash},l.ListAssets().then(function(e){void 0!==e.success&&e.success?""!=e.data.assets&&e.data.assets.forEach(function(e){"unspent"==e.status&&(c.assetsIssued.push({symbol:e.symbol}),e.symbol==c.symbol&&(c.balance["total-unspent"]=e.quantity,c.balance["total-frozen"]=e.quantity,c.decimal_number=e.decimal_number))}):(u("MESSAGES.ASSETS_LOAD_ERROR").then(function(e){return i.Error(e)}),m.scrollTo(0,0)),"ETP"==c.symbol&&s.GetBalance(function(e,s,t){e?(i.Error(t),m.scrollTo(0,0)):(c.balance=s,c.decimal_number=8,c.availableBalance=s["total-available"])})}),c.deposit_options={"DEPOSIT.PERIOD.WEEK":[9589e-7,.05,7,25200],"DEPOSIT.PERIOD.MONTH":[.0066667,.08,30,108e3],"DEPOSIT.PERIOD.QUARTER":[.032,.128,90,331200],"DEPOSIT.PERIOD.HALF_YEAR":[.08,.16,182,655200],"DEPOSIT.PERIOD.YEAR":[.2,.2,365,1314e3]},c.setDepositPeriod=function(e){c.period_select=e},c.$watch("value",function(e,s){c.error.value_empty=null==e||""==e||e<0,c.error.value_not_enough_balance=null!=e&&""!=e&&e>(c.availableBalance-1e8*c.transactionFee)/1e8,c.error.value_not_a_number=null!=e&&""!=e&&isNaN(e),r()}),c.$watch("period_select",function(e,s){c.error.period_empty=null==e||""==e,r()}),c.$watch("deposit_address",function(e,s){c.option.deposit_address_empty=null==e||""==e,c.option.deposit_address_incorrect=null!=e&&""!=e&&!(("testnet"==t.network&&"t"==e.charAt(0)||"mainnet"==t.network&&"M"==e.charAt(0)||"3"==e.charAt(0))&&34==e.length&&e.match(/^[0-9A-Za-z]+$/)),r()}),c.$watch("transactionFee",function(e,s){c.error.fee_empty=null==e,c.error.fee_too_low=null!=e&&e<1e-4,c.error.fee_not_a_number=null!=e&&isNaN(e),r()}),c.$watch("password",function(e,s){c.errorPassword=null==e||""==e,r()}),h()}function r(d,e,a,u,m,o,f,h,p){function S(){s(),u.sendfrom="",u.sendto="",u.fee="",u.message="",u.value="",u.password="",u.transactionFee=1e-4,u.memo="",u.confirmation=!1,u.error=[],u.option=[],u.option.memo_empty=!0,u.recipientOK=[],u.amountOK=[],u.recipents=[],u.recipents.push({index:1,address:"",value:"",correctEtpAddress:!1,correctAvatar:!1,burnAddress:!1,emptyAmount:!0,wrongAmount:!1,notEnough:!1})}function s(){e.GetBalance(function(e,s,t){e?(m.Error(t),h.scrollTo(0,0)):(u.balance=s,u.availableBalance=s["total-available"])})}function t(e,s){void 0===e?(u.recipents[s-1].correctEtpAddress=!1,u.recipents[s-1].correctAvatar=!1,u.recipents[s-1].burnAddress=!1,u.recipientOK[s-1]=!1):("testnet"==a.network&&"t"==e.charAt(0)||"mainnet"==a.network&&"M"==e.charAt(0)||"3"==e.charAt(0))&&34==e.length&&e.match(/^[0-9A-Za-z]+$/)?(u.recipents[s-1].correctEtpAddress=!0,u.recipents[s-1].correctAvatar=!1,u.recipents[s-1].burnAddress=!1,u.recipientOK[s-1]=!0):-1<u.allDidsSymbols.indexOf(e)?(u.recipents[s-1].correctEtpAddress=!1,u.recipents[s-1].correctAvatar=!0,u.recipents[s-1].burnAddress=!1,u.recipientOK[s-1]=!0):e==d.burnAddress||p("lowercase")(e)==d.burnAddress_short?(u.recipents[s-1].correctEtpAddress=!1,u.recipents[s-1].correctAvatar=!1,u.recipents[s-1].burnAddress=!0,u.recipientOK[s-1]=!0):(u.recipents[s-1].correctEtpAddress=!1,u.recipents[s-1].correctAvatar=!1,u.recipents[s-1].burnAddress=!1,u.recipientOK[s-1]=!1),n()}function r(e,s){void 0===e||""===e?(u.recipents[s-1].emptyAmount=!0,u.recipents[s-1].wrongAmount=!1,u.recipents[s-1].notEnough=!1,u.amountOK[s-1]=!1):e<0?(u.recipents[s-1].emptyAmount=!1,u.recipents[s-1].wrongAmount=!0,u.recipents[s-1].notEnough=!1,u.amountOK[s-1]=!1):e>u.availableBalance/1e8-u.transactionFee?(u.recipents[s-1].emptyAmount=!1,u.recipents[s-1].wrongAmount=!1,u.recipents[s-1].notEnough=!0,u.amountOK[s-1]=!1):(u.recipents[s-1].emptyAmount=!1,u.recipents[s-1].wrongAmount=!1,u.recipents[s-1].notEnough=!1,u.amountOK[s-1]=!0),n()}function n(){for(var e in u.error)if(u.error[e])return void(u.submittable=!1);for(var s in u.recipientOK)if(!u.recipientOK[s])return void(u.submittable=!1);for(var t in u.amountOK)if(!u.amountOK[t])return void(u.submittable=!1);u.submittable=!0}function l(e){u.availableBalance=""==e?u.balance["total-available"]:u.addresses[e].available,r(u.recipents[0].value,1)}h.scrollTo(0,0),NProgress.start(),u.transfer=function(e,s,t,r,n){o.get("credentials").password!=n?(f("MESSAGES.WRONG_PASSWORD").then(function(e){return m.Error(e)}),h.scrollTo(0,0)):(1==s.length?function(e,s,t,r,n){NProgress.start();var a=s[0].value,o=s[0].address,l=!1,c=p("convertfortx")(t,8);a=p("convertfortx")(a,8),u.allDidsAddresses[e]&&(e=u.allDidsAddresses[e],l=!0);if(s[0].correctEtpAddress&&!l)var i=e?d.SendFrom(e,o,a,c,r,n):d.Send(o,a,c,r,n);else if(s[0].burnAddress)var i=e?d.DidSendFrom(d.burnAddress,o,a,c,r,n):d.DidSend(d.burnAddress,a,c,r,n);else var i=e?d.DidSendFrom(e,o,a,c,r,n):d.DidSend(o,a,c,r,n);i.then(function(s){NProgress.done(),void 0!==s.success&&s.success?(f("MESSAGES.TRANSFER_SUCCESS").then(function(e){return m.Success(e,!1,s.data.result.transaction.hash)}),h.scrollTo(0,0),S()):(f("MESSAGES.TRANSFER_ERROR").then(function(e){u.confirmation=!1,null!=s.message.message?m.Error(e+" "+s.message.message):m.Error(e)}),h.scrollTo(0,0),u.password="")})}(e,s,t,r,n):function(e,s,t,r,n){NProgress.start();var a=[],o=1e8*t;s.forEach(function(e){var s=e.value;s*=1e8,s=Math.round(s),e.burnAddress&&(e.address=d.burnAddress),a.push({address:e.address,value:s})}),d.DidSendMore(a,o,n).then(function(s){NProgress.done(),void 0!==s.success&&s.success?(f("MESSAGES.TRANSFER_SUCCESS").then(function(e){return m.Success(e,!1,s.data.result.transaction.hash)}),h.scrollTo(0,0),S()):(u.confirmation=!1,f("MESSAGES.TRANSFER_ERROR").then(function(e){null!=s.message.message?m.Error(e+" "+s.message.message):m.Error(e)}),h.scrollTo(0,0),u.password="")})}(0,s,t,0,n),h.scrollTo(0,0),u.password="")},u.typeTransaction="simple",u.getBalance=s,u.listAddresses=[],u.symbol="ETP",u.availBalance=l,u.availableBalance=0,u.sendAll=function(){u.recipents[0].value=(u.availableBalance-1e8*u.transactionFee)/1e8,r(u.recipents[0].value,1)},u.checkRecipent=t,u.checkAmount=r,u.allDids=[],u.allDidsAddresses=[],u.checkInputs=function(e,s,t,r,n){u.confirmation=!0,delete a.flash},u.didFromAddress=[],s(),d.ListAllDids().then(function(e){void 0!==e.success&&e.success?(u.allDids=e.data.result.dids,u.allDidsSymbols=[],void 0!==u.allDids&&null!=u.allDids?u.allDids.forEach(function(e){u.allDidsSymbols.push(e.symbol),u.allDidsAddresses[e.address]=e.symbol,u.didFromAddress[e.symbol]=e.address}):u.allDids=[]):(f("MESSAGES.CANT_LOAD_ALL_DIDS").then(function(e){return m.Error(e)}),h.scrollTo(0,0)),t(u.recipents[0].address,1),r("",1)}),u.$watch("sendfrom",function(e,s){u.error.sendfrom=null==e,r(u.recipents[0].value,1),n()}),u.$watch("transactionFee",function(e,s){u.error.fee_empty=null==e,u.error.fee_too_low=null!=e&&e<1e-4,n()}),u.$watch("memo",function(e,s){u.option.memo_empty=null==e||""==e,u.error.memo_wrong_char=!1,n()}),u.$watch("password",function(e,s){u.errorPassword=null==e||""==e,n()}),u.addRecipent=function(){u.recipents.push({index:u.recipents.length+1,address:"",value:"",correctEtpAddress:!1,correctAvatar:!1,burnAddress:!1,emptyAmount:!0,wrongAmount:!1,notEnough:!1}),u.sendfrom="",u.recipientOK.push(!1),u.amountOK.push(!1),l(""),n()},u.removeRecipent=function(){u.recipents.splice(u.recipents.length-1,1),u.recipientOK.splice(u.recipientOK.length-1,1),u.amountOK.splice(u.recipientOK.length-1,1),r(u.recipents[0].value,1),l(""),n()},NProgress.start(),d.ListBalances().then(function(e){void 0!==e.success&&e.success&&(u.addresses=[],e.data.balances.forEach(function(e){var s="New address";null!=o.get(e.balance.address)&&(s=o.get(e.balance.address)),u.addresses[e.balance.address]={balance:parseInt(e.balance.unspent),available:parseInt(e.balance.available),address:e.balance.address,name:s,frozen:e.balance.frozen,type:"single"},u.listAddresses.push({balance:parseInt(e.balance.unspent),available:parseInt(e.balance.available),address:e.balance.address})}),d.ListMultiSig().then(function(e){void 0!==e.success&&e.success&&""!=e.data.multisig&&e.data.multisig.forEach(function(e){u.addresses[e.address].type="multisig"})}))}),NProgress.done(),S(),NProgress.done()}function n(r,e,s,t,n,a,o,l,c,i){function d(){a.resultSignTx="",a.error=[],a.transaction=""}a.transferSuccess=!1,a.signMultisigTx=function(e,s,t){null==s||l.get("credentials").password!=s?(c("MESSAGES.WRONG_PASSWORD").then(function(e){return o.Error(e)}),i.scrollTo(0,0)):r.SignMultisigTx(e,s,t).then(function(s){NProgress.done(),void 0!==s.success&&s.success?(t?c("MESSAGES.SIGN_AND_BROADCAST_SUCCESS").then(function(e){return o.Success(e)}):c("MESSAGES.SIGN_SUCCESS").then(function(e){return o.Success(e)}),i.scrollTo(0,0),d(),a.transferSuccess=!0,a.resultSignTx=s.data.result):(c("MESSAGES.SIGN_ERROR").then(function(e){null!=s.message&&null!=s.message.message?o.Error(e+" "+s.message.message):o.Error(e)}),i.scrollTo(0,0))})},a.lastTx=!1,a.symbol=s("uppercase")(t.path().split("/")[3]),a.$watch("password",function(e,s){a.errorPassword=null==e||""==e}),d()}function a(l,e,s,c,t,i,d,r,u,m){function f(){i.sendfrom="",i.sendto="",i.fee="",i.message="",i.value="",i.password="",i.availableBalance=0,i.error=[],i.transferSuccess=!1,i.resultCreateTx="",i.correctEtpAddress=!1,i.correctAvatar=!1,i.burnAddress=!1,i.confirmation=!1}function n(e){void 0===e||""==e?(i.correctEtpAddress=!1,i.correctAvatar=!1,i.burnAddress=!1,i.correctMutliSignAddress=!1):(("testnet"==t.network&&"t"==e.charAt(0)||"mainnet"==t.network&&"M"==e.charAt(0)||"3"==e.charAt(0))&&34==e.length&&e.match(/^[0-9A-Za-z]+$/)?(i.correctEtpAddress=!0,i.correctAvatar=!1,i.burnAddress=!1):-1<i.allDidsSymbols.indexOf(e)?(i.correctEtpAddress=!1,i.correctAvatar=!0,i.burnAddress=!1):e==l.burnAddress||c("lowercase")(e)==l.burnAddress_short?(i.correctEtpAddress=!1,i.correctAvatar=!1,i.burnAddress=!0):(i.correctEtpAddress=!1,i.correctAvatar=!1,i.burnAddress=!1),i.correctMultiSignAddress=!1),a()}function a(){for(var e in i.error)if(i.error[e])return void(i.submittable=!1);i.correctEtpAddress||i.correctAvatar||i.burnAddress?i.submittable=!0:i.submittable=!1}m.scrollTo(0,0),NProgress.start(),i.symbol=c("uppercase")(s.path().split("/")[3]),i.sendAllMultisig=function(){i.quantity="ETP"==i.symbol?(i.availableBalance-1e8*i.transactionFee)/1e8:parseFloat(c("converttodisplay")(i.availableBalance,i.decimal_number)),i.quantity<0&&(i.quantity=0)},i.transactionFee=1e-4,i.listAddresses=[],i.listMultiSig=[],i.listAssetMultiSig=[],i.createMultisigTx=function(e,s,t,r,n){i.burnAddress?s=l.burnAddress:i.correctAvatar&&(s=i.didFromAddress[s]);i.didFromAddress[e]&&(e=i.didFromAddress[e]);var a=c("convertfortx")(t,i.decimal_number),o=c("convertfortx")(r,8);("ETP"==i.symbol?l.CreateMultisigTx(e,s,a,o,n):l.CreateAssetMultisigTx(i.symbol,e,s,a,o,n)).then(function(s){NProgress.done(),void 0!==s.success&&s.success?(u("MESSAGES.CREATE_MULTISIGNATURE_SUCCESS").then(function(e){return d.Success(e)}),m.scrollTo(0,0),f(),i.transferSuccess=!0,i.resultCreateTx=s.data.result):(u("MESSAGES.CREATE_MULTISIGNATURE_ERROR").then(function(e){null!=s.message&&null!=s.message.message?d.Error(e+" "+s.message.message):d.Error(e),m.scrollTo(0,0)}),i.password="")})},i.transferSuccess=!1,i.resultCreateTx="",i.checkRecipent=n,i.allDids=[],i.allDidsSymbols=[],i.checkInputs=function(){i.confirmation=!0,delete t.flash},i.didFromAddress=[],i.allDidsAddresses=[],i.availBalance=function(e){i.availableBalance=i.addresses[e].available,i.error.quantity_not_enough_ETP_balance=null!=i.quantity&&""!=i.quantity&&"ETP"==i.symbol&&parseInt(c("convertfortx")(i.quantity,8))>parseInt(i.availableBalance)-parseInt(c("convertfortx")(i.transactionFee,8))},i.availBalanceAsset=function(s){i.assetAddresses.forEach(function(e){e.address==s&&(i.availableBalance=e.quantity-e.locked_quantity)}),i.error.quantity_not_enough_balance=null!=i.quantity&&""!=i.quantity&&"ETP"!=i.symbol&&parseInt(c("convertfortx")(i.quantity,i.decimal_number))>parseInt(i.availableBalance)},i.assetAddresses=[],e.GetBalance(function(e,s,t){e?(d.Error(t),m.scrollTo(0,0)):i.balance=s}),NProgress.start(),l.ListBalances().then(function(e){void 0!==e.success&&e.success&&(i.addresses=[],e.data.balances.forEach(function(e){var s="New address";null!=r.get(e.balance.address)&&(s=r.get(e.balance.address)),i.addresses[e.balance.address]={balance:parseInt(e.balance.unspent),available:parseInt(e.balance.available),address:e.balance.address,name:s,frozen:e.balance.frozen,type:"single"},i.listAddresses.push({balance:parseInt(e.balance.unspent),available:parseInt(e.balance.available),address:e.balance.address})}),l.ListMultiSig().then(function(e){void 0!==e.success&&e.success&&""!=e.data.multisig&&e.data.multisig.forEach(function(e){i.addresses[e.address].type="multisig";var s="New address";null!=r.get(e.address)&&(s=r.get(e.address));i.listMultiSig.push({index:e.index,m:e.m,n:e.n,selfpublickey:e["self-publickey"],description:e.description,address:e.address,name:s,balance:i.addresses[e.address].balance,available:i.addresses[e.address].available,publicKeys:e["public-keys"]})})})),NProgress.done()}),"ETP"!=i.symbol?l.GetAccountAsset(i.symbol).then(function(e){void 0!==e.success&&e.success?(i.assetAddresses=e.data.result.assets,i.assetAddresses&&(i.decimal_number=i.assetAddresses[0].decimal_number,i.assetAddresses.forEach(function(e){"3"==e.address.charAt(0)&&(i.listAssetMultiSig[e.address]=e)}))):(u("MESSAGES.ASSETS_LOAD_ERROR").then(function(e){return d.Error(e)}),m.scrollTo(0,0))}):i.decimal_number=8,l.ListAllDids().then(function(e){void 0!==e.success&&e.success?(i.allDids=e.data.result.dids,void 0!==i.allDids&&null!=i.allDids?i.allDids.forEach(function(e){i.allDidsSymbols.push(e.symbol),i.allDidsAddresses[e.address]=e.symbol,i.didFromAddress[e.symbol]=e.address}):i.allDids=[]):(u("MESSAGES.CANT_LOAD_ALL_DIDS").then(function(e){return d.Error(e)}),m.scrollTo(0,0)),n(i.sendTo)}),i.$watch("sendfrom",function(e,s){i.error.sendfrom=null==e||""==e,a()}),i.$watch("sendTo",function(e,s){i.error.sendTo_empty=null==e||""==e,a()}),i.$watch("quantity",function(e,s){i.error.quantity_empty=null==e,i.error.quantity_not_enough_ETP_balance=null!=i.quantity&&""!=i.quantity&&"ETP"==i.symbol&&parseInt(c("convertfortx")(i.quantity,8))>parseInt(i.availableBalance)-parseInt(c("convertfortx")(i.transactionFee,8)),i.error.quantity_not_enough_balance=null!=i.quantity&&""!=i.quantity&&"ETP"!=i.symbol&&parseInt(c("convertfortx")(i.quantity,i.decimal_number))>parseInt(i.availableBalance),a()}),i.$watch("transactionFee",function(e,s){i.error.fee_empty=null==e,i.error.fee_too_low=null!=e&&e<1e-4,a()}),i.$watch("password",function(e,s){i.errorPassword=null==e||""==e}),f()}function o(s,e,t,r,n,a,o,l,c){function i(){n.sendfrom="",n.publicKey="",n.cosigners=[],n.cosigners.push({index:1,publicKey:""}),n.cosignersError=[],n.cosignersError.push(!0),n.nbrCosignersRequired="",n.transferSuccess=!1,n.resultCreateTx="",n.submittable=!1}function d(){for(var e in n.error)if(n.error[e])return void(n.submittable=!1);for(var s in n.cosignersError)if(n.cosignersError[s])return void(n.submittable=!1);n.submittable=!0}c.scrollTo(0,0),NProgress.start(),n.displayEmptyAdresses=!1,n.recipents=[],n.buttonCopyToClipboard=new Clipboard(".btn"),n.getPublicKey=function(e){NProgress.start(),s.GetPublicKey(e).then(function(e){void 0!==e.success&&e.success?n.publicKey=e.data["public-key"]:(l("MESSAGES.ADDRESS_NOT_FOUND").then(function(e){return a.Error(e)}),c.scrollTo(0,0))}),NProgress.done()},n.publicKey="",n.cosigners=[],n.getNewMultisign=function(){NProgress.start(),s.GetNewMultiSig(n.nbrCosignersRequired,n.cosigners.length+1,n.publicKey,n.cosigners).then(function(s){NProgress.done(),void 0!==s.success&&s.success?(l("MESSAGES.CREATE_MULTISIGNATURE_SUCCESS").then(function(e){return a.Success(e+" : "+s.data.result.address)}),c.scrollTo(0,0),i()):l("MESSAGES.CREATE_MULTISIGNATURE_ERROR").then(function(e){null!=s.message&&null!=s.message.message?a.Error(e+" : "+s.message.message):a.Error(e),c.scrollTo(0,0)}),NProgress.done()})},n.nbrCosignersRequired=0,n.listAddresses=[],n.listMultiSig=[],n.error=[],n.checkHash=function(e,s){null!=(void 0===e?"undefined":_typeof(e))&&""!=e&&66==e.length&&e.match(/^[0-9A-Za-z]+$/)?n.cosignersError[s-1]=!1:n.cosignersError[s-1]=!0;d()},NProgress.start(),s.ListBalances().then(function(e){void 0!==e.success&&e.success&&(n.addresses=[],e.data.balances.forEach(function(e){var s="New address";null!=o.get(e.balance.address)&&(s=o.get(e.balance.address)),n.addresses[e.balance.address]={balance:parseInt(e.balance.unspent),available:parseInt(e.balance.available),address:e.balance.address,name:s,frozen:e.balance.frozen,type:"single"},n.listAddresses.push({balance:parseInt(e.balance.unspent),available:parseInt(e.balance.available),address:e.balance.address})}),s.ListMultiSig().then(function(e){void 0!==e.success&&e.success&&""!=e.data.multisig&&e.data.multisig.forEach(function(e){n.addresses[e.address].type="multisig";var s="New address";null!=o.get(e.address)&&(s=o.get(e.address));n.listMultiSig.push({index:e.index,m:e.m,n:e.n,selfpublickey:e["self-publickey"],description:e.description,address:e.address,name:s,balance:n.addresses[e.address].balance,available:n.addresses[e.address].available,publicKeys:e["public-keys"]})})})),NProgress.done()}),n.addCoSigner=function(){n.cosigners.push({index:n.cosigners.length+1,publicKey:"",error:!0}),n.cosignersError.push(!0)},n.removeCoSigner=function(){n.cosigners.splice(n.cosigners.length-1,1),n.cosignersError.splice(n.cosignersError.length-1,1)},n.getNumber=function(e){return new Array(e)},n.$watch("sendfrom",function(e,s){n.error.sendfrom=null==e||""==e,d()}),n.$watch("publicKey",function(e,s){n.error.publicKey=null==e||""==e,d()}),n.$watch("nbrCosignersRequired",function(e,s){n.error.nbrCosignersRequired=null==e||""==e,d()}),i()}function l(e,s,t,r,n,a,o,l,c){function i(){NProgress.start(),s.ListBalances().then(function(r){void 0!==r.success&&r.success&&(n.addresses=[],r.data.balances.forEach(function(e,s){var t=l.get(e.balance.address);null==t&&(t="New Address"),n.addresses.push({balance:parseInt(e.balance.unspent),address:e.balance.address,frozen:e.balance.frozen,name:t,edit:!1,index:r.data.balances.length-s})}),n.addressesDisplay=n.addresses,n.addressesFiltered=[],n.addresses.forEach(function(e){0!=e.balance&&n.addressesFiltered.push(e)})),NProgress.done()})}c.scrollTo(0,0),n.addresses=[],n.addressesFiltered=[],n.addressesDisplay=[],n.displayEmpty=function(){n.addressesDisplay=n.addresses},n.hideEmpty=function(){n.addressesDisplay=n.addressesFiltered},n.getnewaddress=function(){s.GetNewAddress().then(function(e){void 0!==e.success&&e.success&&(t("MESSAGES.CREATED_ADDRESS").then(function(e){return a.Success(e)}),c.scrollTo(0,0),i())})},n.showqr=function(e){$("#showqrmodal").modal(),$("#modal_address").html(e),$("#modal_qr").html("");new QRCode(document.getElementById("modal_qr"),{text:e,width:300,height:300,colorDark:"#000000",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.H});$("#showqrmodal").modal("show")},n.buttonCopyToClipboard=new Clipboard(".btn"),n.enableEditAddressName=function(s){n.addresses.forEach(function(e){e.address==s&&(e.newName=e.name,e.edit=!0)})},n.endEditAddressName=function(s,t){l.set(s,t),n.addresses.forEach(function(e){e.address==s&&(e.name=t,e.edit=!1)})},n.cancelEditAddressName=function(s){n.addresses.forEach(function(e){e.address==s&&(e.newName=e.name,e.edit=!1)})},n.newName="New Address",n.myDidsAddresses=[],n.myDidsSymbols=[],n.balance={},"multisignatureaddresses"==o.path().split("/")[2]||"myaddresses"==o.path().split("/")[2]&&i(),e.GetBalance(function(e,s,t){e?(a.Error(t),c.scrollTo(0,0)):n.balance=s}),s.ListMyDids().then(function(e){void 0!==e.success&&e.success?(n.myDids=e.data.result.dids,n.balancesLoaded=!0,void 0!==n.myDids&&null!=n.myDids?n.myDids.forEach(function(e){n.myDidsAddresses[e.address]=e.symbol}):n.myDids=[]):(t("MESSAGES.CANT_LOAD_MY_DIDS").then(function(e){return a.Error(e)}),c.scrollTo(0,0))})}function c(l,r,c,i,e,n,a,d,o,u,m){function f(e,s){var t=JSON.stringify(e),r=new m([t],{type:"application/json"});u.saveAs(r,s+"."+i.empty+"json")}function h(e,s){var t=e.mnemonic,r=e.index;i.addressesNbr=r;var n=JSON.parse(CryptoJS.AES.decrypt(t,s).toString(CryptoJS.enc.Utf8)),a=bip39.mnemonicToSeed(n,l.MetaverseNetwork[c.network]),o=CryptoJS.AES.encrypt(JSON.stringify(a.toString("hex")),s).toString()+"&"+c.network.charAt(0)+"&"+r;$("#showqrmodal").modal(),$("#modal_account").html(d.get("credentials").user),$("#modal_qr").html("");new QRCode(document.getElementById("modal_qr"),{text:o,width:300,height:300,colorDark:"#000000",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.H});$("#showqrmodal").modal("show")}o.scrollTo(0,0),i.showprivatekey=function(e,s){null==e?(r("MESSAGES.PASSWORD_NEEDED_FOR_PRIVATE_KEY").then(function(e){return n.Error(e)}),o.scrollTo(0,0)):d.get("credentials").password!=e?(r("MESSAGES.WRONG_PASSWORD").then(function(e){return n.Error(e)}),o.scrollTo(0,0)):(NProgress.start(),l.GetAccount(s).then(function(e){void 0!==e.success&&e.success?i.privatekey=e.data["mnemonic-key"]:(r("SETTINGS.MNEMONIC_LOAD_ERROR").then(function(e){return n.Error(e)}),o.scrollTo(0,0)),NProgress.done()}))},i.changepassword=function(e,s,t){null==e||d.get("credentials").password!=e?(r("MESSAGES.WRONG_PASSWORD").then(function(e){return n.Error(e)}),o.scrollTo(0,0)):null==s||s.length<6?(r("MESSAGES.PASSWORD_SHORT").then(function(e){return n.Error(e)}),o.scrollTo(0,0)):s!=t?(r("MESSAGES.PASSWORD_NOT_MATCH").then(function(e){return n.Error(e)}),o.scrollTo(0,0)):(NProgress.start(),l.ChangePassword(s).then(function(e){void 0!==e.success&&e.success?r("MESSAGES.CHANGE_PASSWORD_SUCCESS").then(function(e){n.Success(e,!0),a.path("/login")}):(r("SETTINGS.CHANGE_PASSWORD_ERROR").then(function(e){return n.Error(e)}),o.scrollTo(0,0)),NProgress.done()}))},i.exportAccount=function(e,s,t){d.get("credentials").password!=e?(r("MESSAGES.WRONG_PASSWORD").then(function(e){return n.Error(e)}),o.scrollTo(0,0)):(NProgress.start(),l.DumpKeyFile(e,s).then(function(s){void 0!==s.success&&s.success?t?(f(s.data.result,"mvs_keystore_"+d.get("credentials").user),r("MESSAGES.EXPORT_ACCOUNT_FILE_SUCCESS").then(function(e){return n.Success(e)})):h(s.data.result,e):r("MESSAGES.EXPORT_ACCOUNT_FILE_ERROR").then(function(e){null!=s.message?n.Error(e+" "+s.message.message):n.Error(e)}),o.scrollTo(0,0),NProgress.done()}))},i.accountname=d.get("credentials").user,i.debugState=l.debug,i.path="",i.download=f,i.showqr=h,i.empty="",i.addressesNbr=0,i.setDeugger=function(e){l.debug=1==e,i.debugState=l.debug},new m(["text"],{type:"text/plain;charset=utf-8"})}function i(i,e,a,d,u,m,f,h,p,S){function s(e){void 0===e||""==e?(d.correctEtpAddress=!1,d.correctAvatar=!1,d.burnAddress=!1):("testnet"==a.network&&"t"==e.charAt(0)||"mainnet"==a.network&&"M"==e.charAt(0)||"3"==e.charAt(0))&&34==e.length&&e.match(/^[0-9A-Za-z]+$/)?(d.correctEtpAddress=!0,d.correctAvatar=!1,d.burnAddress=!1):"3"==e.charAt(0)&&34==e.length&&e.match(/^[0-9A-Za-z]+$/)?(d.correctEtpAddress=!1,d.correctAvatar=!1,d.burnAddress=!1):-1<d.allDidsSymbols.indexOf(e)?(d.correctEtpAddress=!1,d.correctAvatar=!0,d.burnAddress=!1):e==i.burnAddress||S("lowercase")(e)==i.burnAddress_short?(d.correctEtpAddress=!1,d.correctAvatar=!1,d.burnAddress=!0):(d.correctEtpAddress=!1,d.correctAvatar=!1,d.burnAddress=!1),t()}function t(){for(var e in d.error)if(d.error[e])return void(d.submittable=!1);if(d.correctEtpAddress||d.correctAvatar||d.burnAddress){if(d.frozen_option){if(0==d.model&&d.errorDeposit.periodLocked_empty)return void(d.submittable=!1);if((1==d.model||3==d.model)&&(d.errorDeposit.unlock_number_empty||d.errorDeposit.quantityLocked_empty||d.errorDeposit.quantityLocked_lower_quantity||d.errorDeposit.periodLocked_empty))return void(d.submittable=!1);if(2==d.model&&d.errorDeposit.unlockNumber_empty)return void(d.submittable=!1)}d.submittable=!0}else d.submittable=!1}p.scrollTo(0,0),d.symbol=S("uppercase")(m.path().split("/")[3]),d.sendasset=function(e,s,t,r,n,a){if(f.get("credentials").password!=a)u("MESSAGES.WRONG_PASSWORD").then(function(e){return h.Error(e)}),p.scrollTo(0,0);else{NProgress.start(),d.allDidsAddresses[e]&&(e=d.allDidsAddresses[e]),r=S("convertfortx")(r,d.asset.decimal_number);var o=S("convertfortx")(d.quantityLocked,d.asset.decimal_number),l=S("convertfortx")(n,8);if(d.model=d.frozen_option?d.model:"-1",d.burnAddress)var c=e?i.DidSendAssetFrom(e,i.burnAddress,t,r,d.model,d.unlockNumber,o,d.periodLocked,d.model2ToSend,d.interestRate,l,a):i.DidSendAsset(i.burnAddress,t,r,d.model,d.unlockNumber,o,d.periodLocked,d.model2ToSend,d.interestRate,l,a);else var c=e?i.DidSendAssetFrom(e,s,t,r,d.model,d.unlockNumber,o,d.periodLocked,d.model2ToSend,d.interestRate,l,a):i.DidSendAsset(s,t,r,d.model,d.unlockNumber,o,d.periodLocked,d.model2ToSend,d.interestRate,l,a);c.then(function(s){NProgress.done(),void 0!==s.success&&s.success?u("MESSAGES.ASSETS_TRANSFER_SUCCESS").then(function(e){h.Success(e,!0,s.data.result.transaction.hash),m.path("/asset/myassets")}):(d.confirmation=!1,u("MESSAGES.ASSETS_TRANSFER_ERROR").then(function(e){return h.Error(e+" "+s.message.message)}),p.scrollTo(0,0)),d.password=""})}},d.assetsIssued=[],d.assetAddresses=[],d.availBalance=function(s){""==s?d.availableBalance=d.asset.available:d.assetAddresses.forEach(function(e){e.address==s&&(d.availableBalance=e.quantity-e.locked_quantity)});d.error.quantity_not_enough_balance=null!=d.quantity&&""!=d.quantity&&void 0!==d.asset.decimal_number&&parseInt(S("convertfortx")(d.quantity,d.asset.decimal_number))>parseInt(d.availableBalance)},d.availableBalance=0,d.sendAll=function(){d.quantity=parseFloat(S("converttodisplay")(d.availableBalance,d.asset.decimal_number))},d.checkRecipent=s,d.allDids=[],d.allDidsAddresses=[],d.checkInputs=function(e,s){if(d.frozen_option&&2==d.model){var t=!0;d.unlockNumber=parseInt(d.unlockNumberString),d.model2ToSend=s.slice(0,d.unlockNumber);var r=0,n=0;d.model2ToSend.forEach(function(e){r+=e.number,n+=e.quantity,e.quantityToSend=S("convertfortx")(e.quantity,d.asset.decimal_number),""!=e.number&&""!=e.quantity||(t=!1,u("MESSAGES.SECONDARY_ISSUE_MODEL2_MISSING_PERIOD_INPUT").then(function(e){return h.Error(e)}),p.scrollTo(0,0))}),d.periodLocked=r,d.quantityLocked=n,d.quantityLocked>d.quantity&&(t=!1,u("MESSAGES.SECONDARY_ISSUE_MODEL2_LOCKED_HIGHER_ISSUED").then(function(e){return h.Error(e)}),p.scrollTo(0,0)),1==t&&(d.confirmation=!0,delete a.flash)}else d.confirmation=!0,delete a.flash},d.didFromAddress=[],d.updateUnlockNumber=function(e){d.model2Displayed=null==e||""==e?0:e},d.checkready=t,i.ListAssets().then(function(e){var s;void 0!==e.success&&e.success?""!=e.data.assets&&(e.data.assets.forEach(function(e){"unspent"==e.status&&d.assetsIssued.push({symbol:e.symbol,quantity:e.quantity,available:e.quantity-e.locked_quantity,decimal_number:e.decimal_number})}),s=d.symbol,i.GetAsset(s).then(function(e){NProgress.done(),void 0!==e.success&&e.success?(d.asset=e.data.assets[0],d.assetsIssued.forEach(function(e){e.symbol==s&&(d.asset.quantity=e.quantity,d.asset.available=e.available,d.availableBalance=e.available)})):u("MESSAGES.ASSETS_LOAD_ERROR").then(function(e){return h.Error(e)})})):(u("MESSAGES.ASSETS_LOAD_ERROR").then(function(e){return h.Error(e)}),p.scrollTo(0,0))}),i.GetAccountAsset(d.symbol).then(function(e){void 0!==e.success&&e.success?d.assetAddresses=e.data.result.assets:(u("MESSAGES.ASSETS_LOAD_ERROR").then(function(e){return h.Error(e)}),p.scrollTo(0,0))}),i.ListAllDids().then(function(e){void 0!==e.success&&e.success?(d.allDids=e.data.result.dids,d.allDidsSymbols=[],void 0!==d.allDids&&null!=d.allDids?d.allDids.forEach(function(e){d.allDidsSymbols.push(e.symbol),d.allDidsAddresses[e.address]=e.symbol,d.didFromAddress[e.symbol]=e.address}):d.allDids=[]):(u("MESSAGES.CANT_LOAD_ALL_DIDS").then(function(e){return h.Error(e)}),p.scrollTo(0,0)),s(d.sendto)}),d.$watch("sendfrom",function(e,s){d.error.sendfrom=null==e,t()}),d.$watch("sendto",function(e,s){d.error.sendto_empty=null==e||""==e,t()}),d.$watch("quantity",function(e,s){d.error.quantity_empty=null==e,d.error.quantity_not_enough_balance=null!=e&&""!=e&&void 0!==d.asset.decimal_number&&parseInt(S("convertfortx")(e,d.asset.decimal_number))>parseInt(d.availableBalance),d.errorDeposit.quantityLocked_lower_quantity=null!=e&&d.quantityLocked>e,t()}),d.$watch("unlockNumber",function(e,s){d.errorDeposit.unlock_number_empty=null==e||""==e,t()}),d.$watch("quantityLocked",function(e,s){d.errorDeposit.quantityLocked_empty=null==e||""==e,d.errorDeposit.quantityLocked_lower_quantity=null!=e&&e>d.quantity,t()}),d.$watch("periodLocked",function(e,s){d.errorDeposit.periodLocked_empty=null==e||""==e,t()}),d.$watch("transactionFee",function(e,s){d.error.fee_empty=null==e,d.error.fee_too_low=null!=e&&e<1e-4,t()}),d.$watch("password",function(e,s){d.errorPassword=null==e||""==e}),function(){d.sendfrom="",d.sendto="",d.message="",d.quantity=void 0,d.password="",d.correctEtpAddress=!1,d.correctAvatar=!1,d.burnAddress=!1,d.confirmation=!1,d.transactionFee=1e-4,d.error=[],d.errorDeposit=[],d.unlockNumber=1,d.unlockNumberString="1",d.interestRate="0",d.model="0",d.model2ToSend=[],d.model2Displayed=1;for(var e=0,s={index:e,number:"",quantity:""},t=new Array(100);e<100;s={index:++e,number:"",quantity:""})t[e]=s;d.model2=t}()}function d(e,s,t,r,n,a,o,l){l.scrollTo(0,0),t.symbol=o.symbol,t.assets=[],t.assetsOriginal=[],t.assetsSecondaryIssue=[],t.icons=e.hasIcon,NProgress.start(),e.ListAllAssets().then(function(e){NProgress.done(),void 0!==e.success&&e.success?(t.assets=[],t.assets=e.data.assets,""!=t.assets&&t.assets.forEach(function(e){e.details=!1,e.icon=-1<t.icons.indexOf(e.symbol)?e.symbol:"default","false"==e.is_secondaryissue?(e.maximum_supply=parseInt(e.maximum_supply),t.assetsOriginal.push(e)):void 0===t.assetsSecondaryIssue[e.symbol]?t.assetsSecondaryIssue[e.symbol]=parseInt(e.maximum_supply):t.assetsSecondaryIssue[e.symbol]+=parseInt(e.maximum_supply)})):a("MESSAGES.ASSETS_LOAD_ERROR").then(function(e){n.Error(e)})})}function u(s,e,t,r,n,a,o,l,c,i,d){c.scrollTo(0,0),t.symbol=o.symbol,t.assets=[],t.issue=function(e){NProgress.start(),s.Issue(e).then(function(s){void 0!==s.success&&s.success?a("MESSAGES.ASSETS_ISSUE_SUCCESS").then(function(e){return n.Success(e,!1,s.data.result.transaction.hash)}):a("MESSAGES.ASSETS_ISSUE_ERROR").then(function(e){return n.Error(e)}),c.scrollTo(0,0),NProgress.done()})},t.deleteAsset=function(e){s.Delete(e).then(function(e){NProgress.done(),void 0!==e.success&&e.success?(a("MESSAGES.ASSETS_DELETE_SUCCESS").then(function(e){return n.Success(e,!0)}),c.scrollTo(0,0),l.path("/home")):(a("MESSAGES.ASSETS_DELETE_ERROR").then(function(e){return n.Error(e)}),c.scrollTo(0,0))})},t.buttonCopyToClipboard=new Clipboard(".btn"),t.icons=s.hasIcon,t.assetsLoaded=!1,t.assets=[],NProgress.start(),s.ListAssets().then(function(e){""!=e.data.assets?void 0!==e.success&&e.success?(t.assets=e.data.assets,t.assets.forEach(function(e){e.icon=-1<t.icons.indexOf(e.symbol)?e.symbol:"default"}),null!=t.symbol&&""!=t.symbol&&(NProgress.start(),loadasset(t.symbol))):a("MESSAGES.ASSETS_LOAD_ERROR").then(function(e){return n.Error(e)}):null!=t.symbol&&""!=t.symbol&&(NProgress.start(),loadasset(t.symbol)),NProgress.done(),t.assetsLoaded=!0}),t.closeAll=function(){i.closeAll()}}function m(e,s,r,n,t,a,o,l,c,i,d){r.symbol=o.symbol,r.asset=[],r.assets=[],r.enableEditAddressName=function(s){r.assetAddresses.forEach(function(e){e.address==s&&(e.newName=e.name,e.edit=!0)})},r.endEditAddressName=function(s,t){n.set(s,t),r.assetAddresses.forEach(function(e){e.address==s&&(e.name=t,e.edit=!1)})},r.cancelEditAddressName=function(s){r.assetAddresses.forEach(function(e){e.address==s&&(e.newName=e.name,e.edit=!1)})},r.showqr=function(e){$("#showqrmodal").modal(),$("#modal_address").html(e),$("#modal_qr").html("");new QRCode(document.getElementById("modal_qr"),{text:e,width:300,height:300,colorDark:"#000000",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.H});$("#showqrmodal").modal("show")},r.buttonCopyToClipboard=new Clipboard(".btn"),r.assetsLoaded=!1,r.assetOriginal=0,r.assetSecondaryIssue=0,r.assetAddresses=[],r.getAssetBalance=[],r.myDidsAddresses=[],e.GetAsset(r.symbol).then(function(e){void 0!==e.success&&e.success?""!=e.data.assets&&(r.assets=e.data.assets,r.asset=e.data.assets[0],r.assets.forEach(function(e){"false"==e.is_secondaryissue?r.assetOriginal=parseInt(e.maximum_supply):r.assetSecondaryIssue+=parseInt(e.maximum_supply)})):(a("MESSAGES.ASSETS_LOAD_ERROR").then(function(e){return t.Error(e)}),c.scrollTo(0,0)),NProgress.done()}),e.GetAccountAsset(r.symbol).then(function(e){void 0!==e.success&&e.success&&null!=e.data.result.assets&&(r.assetAddresses=e.data.result.assets,r.assetAddresses.forEach(function(e){var s="New address";null!=n.get(e.address)&&(s=n.get(e.address)),e.name=s,e.edit=!1,r.getAssetBalance[e.address]=e.quantity}))}),e.ListMyDids().then(function(e){void 0!==e.success&&e.success?(r.myDids=e.data.result.dids,r.balancesLoaded=!0,r.myDidsSymbols=[],void 0!==r.myDids&&null!=r.myDids?r.myDids.forEach(function(e){r.myDidsAddresses[e.address]=e.symbol}):r.myDids=[]):(a("MESSAGES.CANT_LOAD_MY_DIDS").then(function(e){return t.Error(e)}),c.scrollTo(0,0))}),NProgress.start(),e.ListBalances().then(function(t){void 0!==t.success&&t.success&&(r.addressIndex=[],t.data.balances.forEach(function(e,s){r.addressIndex[e.balance.address]=t.data.balances.length-s})),NProgress.done()})}function f(t,o,l,r,s,c,i,d,n,u){function a(e){t.GetAsset(e).then(function(e){void 0!==e.success&&e.success?""!=e.data.assets&&(l.assets=e.data.assets,l.assetSecondaryIssue=0,l.assets.forEach(function(e){"false"==e.is_secondaryissue?l.assetOriginal=parseInt(e.maximum_supply):0==typeof l.assetSecondaryIssue?l.assetSecondaryIssue=parseInt(e.maximum_supply):l.assetSecondaryIssue+=parseInt(e.maximum_supply)})):(i("MESSAGES.ASSETS_LOAD_ERROR").then(function(e){return c.Error(e)}),d.scrollTo(0,0)),NProgress.done(),l.error.address_not_enough_asset=null!=l.address&&null!=l.myAsset&&127!=l.myAsset.secondaryissue_threshold&&0!=l.myAsset.secondaryissue_threshold&&(l.getAssetBalance[l.address]/(l.assetOriginal+l.assetSecondaryIssue)*100<l.myAsset.secondaryissue_threshold||null==l.getAssetBalance[l.address]),h()})}function m(e){l.getAssetBalance=[],l.loadingAvatars=!0,t.GetAccountAsset(e).then(function(e){void 0!==e.success&&e.success&&null!=e.data.result.assets&&(l.assetAddresses=e.data.result.assets,l.assetAddresses.forEach(function(e){l.getAssetBalance[e.address]=e.quantity}),f(l.address),l.error.address_not_enough_asset=null!=l.address&&null!=l.myAsset&&127!=l.myAsset.secondaryissue_threshold&&0!=l.myAsset.secondaryissue_threshold&&(l.getAssetBalance[l.address]/(l.assetOriginal+l.assetSecondaryIssue)*100<l.myAsset.secondaryissue_threshold||null==l.getAssetBalance[l.address]),h()),l.avatarsLoaded=!0})}function f(e){l.availableBalance=""!=e&&null!=l.addresses&&null!=l.addresses[e]?l.addresses[e].available:0,l.availableBalanceAsset=""!=e&&null!=l.getAssetBalance&&null!=l.getAssetBalance[e]?l.getAssetBalance[e]:0,h()}function h(){for(var e in l.error)if(l.error[e])return void(l.submittable=!1);l.issueCertOwner?0==l.myAsset.secondaryissue_threshold||127!=l.myAsset.secondaryissue_threshold&&l.availableBalanceAsset/(l.assetOriginal+l.assetSecondaryIssue)*100<l.myAsset.secondaryissue_threshold?l.submittable=!1:1e4<=!l.availableBalance?l.submittable=!1:1!=l.model&&3!=l.model||!(l.errorDeposit.unlock_number_empty||l.errorDeposit.quantityLocked_empty||l.errorDeposit.quantityLocked_lower_quantity||l.errorDeposit.periodLocked_empty)?2==l.model&&l.errorDeposit.unlockNumber_empty?l.submittable=!1:l.submittable=!0:l.submittable=!1:l.submittable=!1}l.symbol=u("uppercase")(r.path().split("/")[3]),l.listAddresses=[],l.listMultiSig=[],l.secondaryIssue=function(){NProgress.start();var e=u("convertfortx")(l.transactionFee,8),s=u("convertfortx")(l.quantityLocked,l.myAsset.decimal_number);t.SecondaryIssue(l.recipientAvatar,l.symbol,l.toTxConvertedQuantity,l.model,l.unlockNumber,s,l.periodLocked,l.model2ToSend,l.interestRate,e,l.password).then(function(s){void 0!==s.success&&s.success?(i("MESSAGES.SECONDARY_ISSUE_SUCCESS").then(function(e){return c.Success(e,!0,s.data.result.transaction.hash)}),r.path("/avatar/myavatars/")):i("MESSAGES.ERROR_SECONDARY_ISSUE").then(function(e){l.confirmation=!1,null!=s.message.message?c.Error(e+" : "+s.message.message):c.Error(e),d.scrollTo(0,0)}),NProgress.done(),l.password=""})},l.checkInputs=function(e,s,t){if(l.recipientAvatar=l.myDidsAddresses[e],2==l.model){var r=!0;l.unlockNumber=parseInt(l.unlockNumberString),l.model2ToSend=t.slice(0,l.unlockNumber);var n=0,a=0;l.model2ToSend.forEach(function(e){n+=e.number,a+=e.quantity,e.quantityToSend=u("convertfortx")(e.quantity,l.myAsset.decimal_number),""!=e.number&&""!=e.quantity||(r=!1,i("MESSAGES.SECONDARY_ISSUE_MODEL2_MISSING_PERIOD_INPUT").then(function(e){return c.Error(e)}),d.scrollTo(0,0))}),l.periodLocked=n,l.quantityLocked=a,l.quantityLocked>l.quantity&&(r=!1,i("MESSAGES.SECONDARY_ISSUE_MODEL2_LOCKED_HIGHER_ISSUED").then(function(e){return c.Error(e)}),d.scrollTo(0,0)),1==r&&(l.confirmation=!0,delete o.flash)}else l.confirmation=!0,delete o.flash},l.myAsset=[],l.myAssets=[],l.updateQuantity=function(e){l.toTxConvertedQuantity=parseInt(u("convertfortx")(e,l.myAsset.decimal_number))},l.availBalance=f,l.myDids=[],l.myDidsSymbols=[],l.myDidsAddresses=[],l.popupSecondaryIssue=function(e){s.get("credentials").password!=e?(i("MESSAGES.WRONG_PASSWORD").then(function(e){return c.Error(e)}),d.scrollTo(0,0)):n.open({template:"secondaryIssue",scope:l})},l.updateUnlockNumber=function(e){l.model2Displayed=null==e||""==e?0:e},l.assetAddresses=[],l.getAssetBalance=[],l.checkready=h,l.updateSymbol=function(s){l.avatarsLoaded=!1,a(s),m(s),l.myAssetsBalances.forEach(function(e){e.symbol==s&&(l.myAsset=e)}),l.issueCertOwner=!1,l.myCerts.forEach(function(e){e.symbol==s&&"issue"==e.cert&&(l.issueCertOwner=!0)}),l.error.address_not_enough_etp=null!=l.address&&null!=l.addresses&&null!=l.addresses[l.address]&&l.addresses[l.address].available<l.transactionFee,h()},l.getAsset=a,l.getAccountAsset=m,l.avatarsLoaded=!1,NProgress.start(),t.ListBalances().then(function(e){void 0!==e.success&&e.success&&(l.addresses=[],e.data.balances.forEach(function(e){l.addresses[e.balance.address]={balance:parseInt(e.balance.unspent),available:parseInt(e.balance.available),address:e.balance.address,name:name,frozen:e.balance.frozen,type:"single"},l.listAddresses.push({balance:parseInt(e.balance.unspent),available:parseInt(e.balance.available),address:e.balance.address})}),t.ListMultiSig().then(function(e){void 0!==e.success&&e.success&&""!=e.data.multisig&&e.data.multisig.forEach(function(e){l.addresses[e.address].type="multisig"})}))}),NProgress.done(),t.ListMyDids().then(function(e){void 0!==e.success&&e.success?(l.myDids=e.data.result.dids,l.balancesLoaded=!0,l.myDidsSymbols=[],void 0!==l.myDids&&null!=l.myDids?l.myDids.forEach(function(e){l.myDidsSymbols.push(e.symbol),l.myDidsAddresses[e.address]=e.symbol}):l.myDids=[]):(i("MESSAGES.CANT_LOAD_MY_DIDS").then(function(e){return c.Error(e)}),d.scrollTo(0,0))}),NProgress.start(),t.ListAssets().then(function(e){void 0!==e.success&&e.success&&""!=e.data.assets?(l.myAssetsBalances=e.data.assets,void 0!==l.symbol&&""!=l.symbol&&l.myAssetsBalances.forEach(function(e){e.symbol==l.symbol&&(l.myAsset=e)})):i("MESSAGES.ASSETS_LOAD_ERROR").then(function(e){return c.Error(e)}),NProgress.done(),l.assetsLoaded=!0}),t.AccountAssetCert().then(function(e){void 0!==e.success&&e.success?(null!=e.data.result.assetcerts?(l.myCerts=e.data.result.assetcerts,l.myCerts.forEach(function(e){e.symbol==l.symbol&&"issue"==e.cert&&(l.issueCertOwner=!0)})):l.myCerts=[],l.myCertsLoaded=!0):(i("MESSAGES.CANT_LOAD_MY_CERTS").then(function(e){return c.Error(e)}),d.scrollTo(0,0))}),l.closeAll=function(){n.closeAll()},l.$watch("symbol",function(e,s){l.error.symbol_empty=null==e||""==e,l.error.symbol_no_secondary_issue=null!=e&&null!=l.myAsset&&0==l.myAsset.secondaryissue_threshold,h()}),l.$watch("address",function(e,s){l.error.address_empty=null==e||""==e,l.error.address_not_enough_etp=null!=e&&null!=l.addresses&&null!=l.addresses[e]&&l.addresses[e].available<l.transactionFee,l.error.address_not_enough_asset=null!=e&&null!=l.myAsset&&127!=l.myAsset.secondaryissue_threshold&&0!=l.myAsset.secondaryissue_threshold&&(l.getAssetBalance[e]/(l.assetOriginal+l.assetSecondaryIssue)*100<l.myAsset.secondaryissue_threshold||null==l.getAssetBalance[e]),h()}),l.$watch("quantity",function(e,s){l.error.quantity=null==e||""==e,l.errorDeposit.quantityLocked_lower_quantity=null!=e&&l.quantityLocked>e,h()}),l.$watch("unlockNumber",function(e,s){l.errorDeposit.unlock_number_empty=null==e||""==e,h()}),l.$watch("quantityLocked",function(e,s){l.errorDeposit.quantityLocked_empty=null==e||""==e,l.errorDeposit.quantityLocked_lower_quantity=null!=e&&e>l.quantity,h()}),l.$watch("periodLocked",function(e,s){l.errorDeposit.periodLocked_empty=null==e||""==e,h()}),l.$watch("transactionFee",function(e,s){l.error.fee_empty=null==e,l.error.fee_too_low=null!=e&&e<1e-4,h()}),l.$watch("password",function(e,s){l.errorPassword=null==e||""==e,h()}),function(){l.didAddress="",l.confirmation=!1,l.transactionFee=1e-4,l.model="",l.assetOriginal=0,l.assetSecondaryIssue=0,l.issueCertOwner=!1,l.myCertsLoaded=!1,l.availableBalance=0,l.balancesLoaded=!1,l.recipientAvatar="",l.avatar="",l.availableBalanceAsset=0,l.model2Displayed=1,l.unlockNumber=1,l.unlockNumberString="1",l.interestRate="0",l.error=[],l.errorDeposit=[],l.model2ToSend=[];for(var e=0,s={index:e,number:"",quantity:""},t=new Array(100);e<100;s={index:++e,number:"",quantity:""})t[e]=s;l.model2=t,a(l.symbol),m(l.symbol)}()}function h(s,e,t,r,n,a,o,l,c,i){function d(){for(var e in t.error)if(t.error[e])return void(t.submittable=!1);t.submittable=!0}function u(e){t.symbol=e,c.open({template:"templateId",scope:t})}l.scrollTo(0,0),t.createasset=function(){if(n.get("credentials").password!=t.password)o("MESSAGES.WRONG_PASSWORD").then(function(e){return r.Error(e)}),l.scrollTo(0,0);else{var e=i("convertfortx")(t.max_supply,t.decimals);NProgress.start(),s.CreateAsset(t.symbol,t.selectedDid,e,t.secondary_offering,t.decimals,t.description,t.secondaryissue_rate).then(function(s){NProgress.done(),void 0!==s.success&&s.success?(u(t.symbol),o("MESSAGES.ASSET_CREATED_LOCAL_SUCCESS").then(function(e){r.Success(e,!0)})):o("MESSAGES.ASSETS_CREATE_ERROR").then(function(e){return r.Error(e+" "+s.message.message)}),l.scrollTo(0,0)}),t.password=""}},t.popupIssue=u,t.issue=function(e){NProgress.start(),s.Issue(e).then(function(s){void 0!==s.success&&s.success?o("MESSAGES.ASSETS_ISSUE_SUCCESS").then(function(e){return r.Success(e,!1,s.data.result.transaction.hash)}):o("MESSAGES.ASSETS_ISSUE_ERROR").then(function(e){return r.Error(e)}),l.scrollTo(0,0),NProgress.done()})},t.checkInputs=function(){t.symbol=i("uppercase")(t.symbol),t.confirmation=!0,delete e.flash},t.myDids=[],t.noDids=!1,t.selectedDid="",t.assets=[],t.listAllAssets=[],t.symbol="",t.description="",t.max_supply="",t.secondary_offering=0,t.decimals="",t.password="",t.confirmation=!1,t.secondaryissue_rate=0,t.error=[],s.ListMyDids().then(function(e){void 0!==e.success&&e.success?e.data.result.dids?(t.noDids=!1,t.myDids=e.data.result.dids):(t.noDids=!0,t.selectedDid="nodid"):(o("MESSAGES.CANT_LOAD_MY_DIDS").then(function(e){return r.Error(e)}),l.scrollTo(0,0))}),s.ListAllAssets().then(function(e){void 0!==e.success&&e.success&&(t.assets=e.data.assets,""!=t.assets&&t.assets.forEach(function(e){t.listAllAssets.push(e.symbol)}))}),s.ListBalances().then(function(e){void 0!==e.success&&e.success&&(t.addresses=[],e.data.balances.forEach(function(e){t.addresses[e.balance.address]={balance:parseInt(e.balance.unspent),available:parseInt(e.balance.available),address:e.balance.address,name:name,frozen:e.balance.frozen}}))}),t.$watch("symbol",function(e,s){t.error.symbol_empty=null==e||""===e,t.error.symbol_too_long=null!=e&&!(e.length<65),t.error.symbol_wrong_char=null!=e&&""!=e&&!e.match(/^[0-9A-Za-z.]+$/),t.error.symbol_already_exist=null!=e&&-1<t.listAllAssets.indexOf(i("uppercase")(e)),d()}),t.$watch("selectedDid",function(e,s){t.error.avatar=null==e||""===e||"nodid"==e,d()}),t.$watch("max_supply",function(e,s){t.error.max_supply_empty=null==e||!(e==parseInt(e))||0==e,t.error.max_supply_decimals_too_high=null!=e&&1e19<e*Math.pow(10,t.decimals),d()}),t.$watch("decimals",function(e,s){t.error.decimals_empty=null==e||!(0<=e&&e<=8)||""===e,t.error.max_supply_decimals_too_high=null!=e&&1e19<t.max_supply*Math.pow(10,e),d()}),t.$watch("description",function(e,s){t.error.description_empty=null==e||!(0<e.length),t.error.description_too_long=null!=e&&!(e.length<65),d()}),t.$watch("password",function(e,s){t.errorPassword=null==e||""==e}),t.closeAll=function(){c.closeAll()}}function p(r,e,s,n,t,a,o,l){function c(s){n.assetType=s,n.transactionsFiltered=[],"ALL"==s?n.transactionsFiltered=n.transactions:n.transactions.forEach(function(e){e.type==s&&n.transactionsFiltered.push(e)})}function i(e,s){for(var t=e;t<s&&!n.stopLoad;t++)r.LoadTransactions(function(e,s){e?(a("MESSAGES.TRANSACTIONS_LOAD_ERROR").then(function(e){return o.Error(e)}),l.scrollTo(0,0)):(1!=s.lastpage&&null!=s.lastpage||(n.stopLoad=!0),s.forEach(function(o){1==o.frozen&&o.recipents.forEach(function(e){for(var s=e.script.replace(/\[ (\w+) ] numequalverify dup hash160 \[ (\w+) \] equalverify checksig/,"$1"),t=s.length,r="",n=0;n<t;n+=2)r+=s.charAt(t-n-2),r+=s.charAt(t-n-1);var a=parseInt(r,16);o.availableBlockNo=parseInt(o.height)+parseInt(a)}),n.transactions.push(o)}),c("ALL")),NProgress.done()},"asset",t)}l.scrollTo(0,0),n.assets=[],n.balance={},n.transactions=[],n.transactionsFiltered=[],n.showDates=!1,n.startDate=new Date(new Date-6048e5),n.endDate=new Date,n.startDateUpdated=new Date,n.endDateUpdated=new Date,n.assetType="ALL",n.loadTransactions=i,n.loadMore=function(){n.stopLoad||(n.page=n.page+1,i(n.page-1,n.page))},n.stopLoad=!1,n.page=3,n.icons=e.hasIcon,n.filterTransactions=c,r.GetBalance(function(e,s,t){e?o.Error(t):n.balance=s}),e.ListAssets().then(function(e){void 0!==e.success&&e.success?void 0!==e.data.assets&&""!=e.data.assets?(n.assets=e.data.assets,n.assets.forEach(function(e){e.icon=-1<n.icons.indexOf(e.symbol)?e.symbol:"default"})):n.assets="":(a("MESSAGES.ASSETS_LOAD_ERROR").then(function(e){return o.Error(e)}),l.scrollTo(0,0))}),i(1,3)}function S(e,s,t,r,n,a){a.scrollTo(0,0);var o=new WebSocket("ws://"+e.SERVER+"/ws");$("#inputField").focus(),n.showConnected=!1,n.index=0,n.queryHistory=0,o.onmessage=function(e){n.showConnected=!0,n.index++,NProgress.done(),n.consolelog.push({query:n.querystring,answer:e.data,index:n.index}),n.queryHistory=n.consolelog.length,n.querystring="",n.$apply(),window.setTimeout(function(){var e=document.getElementById("consolelog");e.scrollTop=e.scrollHeight},100)},n.querystring="",n.consolelog=[],n.query=function(){if("clear"==n.querystring){var e=n.consolelog[0];n.consolelog=[],n.consolelog.push(e),n.querystring="",n.queryHistory=0}else NProgress.start(),o.send(n.querystring)},n.arrowup=function(){1<n.queryHistory&&(n.queryHistory--,n.querystring=n.consolelog[n.queryHistory].query)},n.arrowdown=function(){n.queryHistory<n.consolelog.length-1?(n.queryHistory++,n.querystring=n.consolelog[n.queryHistory].query):(n.queryHistory=n.consolelog.length-1)&&(n.queryHistory++,n.querystring="")}}function g(r,s,n,t,e,a,o,l,c,i){this.account=t.get("credentials").user,n.height="",n.assets=[],n.language=t.get("language"),n.getHeightFromExplorer=u,n.heightFromExplorer=0,n.loadingPercent=0,n.subscribed=!1;var d=new WebSocket("ws://"+r.SERVER2+"/ws");function u(){var e="testnet"==s.network?"https://explorer-testnet.mvs.org/api/height":"https://explorer.mvs.org/api/height";c.get(e).then(function(e){n.popoverSynchShown||($(function(){$(".popover-show").popover("show")}),n.popoverSynchShown=!0),n.heightFromExplorer=e.data.result,n.loadingPercent=Math.floor(n.height/n.heightFromExplorer*100)}).catch(function(e){return console.log("Cannot get Height from explorer")})}function m(){r.GetInfoV2().then(function(e){void 0!==e&&e.success&&(n.height=e.data.result.height,s.network=e.data.result.testnet?"testnet":"mainnet",n.peers=e.data.result.peers)}).then(function(){return u()}).then(function(){return n.loadingPercent=Math.floor(n.height/n.heightFromExplorer*100)})}function f(e){var s,t;""===e||null==e?o.path("/explorer/search/"):"ETP"===l("uppercase")(e)?o.path("/addresses/myaddresses"):64===e.length?o.path("/explorer/tx/"+e):34===e.length||e==r.burnAddress||e==l("lowercase")(r.burnAddress_short)?o.path("/explorer/adr/"+e):isNaN(e)?(t="/explorer/noresult/"+(s=e),NProgress.start(),r.ListAllAssets().then(function(e){NProgress.done(),void 0!==e.success&&e.success?e.data.assets.forEach(function(e){l("uppercase")(s)==e.symbol&&(t="/asset/details/"+s)}):(a("MESSAGES.ASSETS_LOAD_ERROR").then(function(e){return i.Error(e)}),$window.scrollTo(0,0)),o.path(t)}),NProgress.done()):o.path("/explorer/blk/"+e)}n.showConnected=!1,n.index=0,n.sound=!0,n.version="",n.popoverSynchShown=!1,n.peers="",r.GetInfoV2().then(function(e){void 0!==e.success&&e.success&&(n.height=e.data.result.height,s.network=e.data.result.testnet?"testnet":"mainnet",n.version=e.data.result["wallet-version"],n.checkVersion(),n.peers=e.data.result.peers)}).then(function(){return u()}).then(function(){return n.loadingPercent=Math.floor(n.height/n.heightFromExplorer*100)}),n.ClickCloseFlashMessage=function(){i.CloseFlashMessage()},n.checkVersion=function(){"<"==n.version.charAt(0)||c.get("https://explorer.mvs.org/api/fullnode/version").then(function(e){var s=n.version.split("."),t=e.data.support.split("."),r=e.data.current.split(".");n.checkNeedUpdate(s,t)?a("MESSAGES.NEW_VERSION_MAJOR_CHANGE").then(function(e){return i.Error(e,!1,"","mvs.org")}):n.checkNeedUpdate(s,r)&&a("MESSAGES.NEW_VERSION_AVAILABLE").then(function(e){return i.Warning(e,!1,"","mvs.org")})}).catch(function(e){return console.log("Cannot get Version from explorer")})},n.checkNeedUpdate=function(e,s){return e[0]<s[0]||e[0]==s[0]&&e[1]<s[1]||e[0]==s[0]&&e[1]==s[1]&&e[2]<s[2]},d.onmessage=function(e){var s=JSON.parse(e.data);n.subscribed?"tx"==s.channel&&"publish"==s.event&&"0"!=s.result.height&&parseInt(n.heightFromExplorer)-parseInt(n.height)<100&&(a("MESSAGES.TX_PROCESSED").then(function(e){return i.Info(e,!1,s.result.hash)}),n.sound&&n.playNewTx()):(n.subscribed=!0,n.subscribeToAllMyAddresses())},n.playNewTx=function(){new Audio("audio/message.mp3").play()},n.onOffSound=function(){n.sound=!n.sound},n.subscribeToAllMyAddresses=function(){NProgress.start(),r.ListBalances().then(function(e){void 0!==e.success&&e.success&&e.data.balances.forEach(function(e){d.send(JSON.stringify({event:"subscribe",channel:"tx",address:e.balance.address}))}),NProgress.done()})},n.menu={account:{show:0},assets:{show:0}},this.changeLang=function(e){return a.use(e).then(function(e){return t.set("language",e)}).catch(function(e){return console.log("Cannot change language.")})},m(),e(function(){return m()},1e4),n.show_account_menu=function(){n.menu.account.show=1-n.menu.account.show,n.menu.assets.show=0},n.show_assets_menu=function(){n.menu.assets.show=1-n.menu.assets.show,n.menu.account.show=0},this.search=function(e){return f(e)}}function v(e,s,t,r,n,a,o,l){function c(e){t.loadingAddressHistory=!0,s.GetDid(e).then(function(s){void 0!==s.success&&s.success?t.addressesHistory=s.data.result.addresses:(n("MESSAGES.LISTDIDSADDRESSE_LOAD_ERROR").then(function(e){null!=s.message.message?l.Error(e+" "+s.message.message):l.Error(e)}),a.scrollTo(0,0)),t.loadingAddressHistory=!1})}t.selectedDid=r.path().split("/")[3],t.myDids=[],t.myCerts=[],t.loadingDids=!0,t.onChain=!0,t.myCertsLoaded=!1,t.loadingAddressHistory=!0,t.listDidsAddresses=c,t.addressesHistory=[],t.changeDid=function(e){c(e)},s.ListMyDids().then(function(e){void 0!==e.success&&e.success?(t.loadingDids=!1,e.data.result.dids?(t.myDids=e.data.result.dids,"indefined"!=typeof t.selectedDid&&""!=t.selectedDid||(t.selectedDid=t.myDids[0].symbol),c(t.selectedDid)):(t.myDids=[],t.selectedDid="")):(n("MESSAGES.CANT_LOAD_MY_DIDS").then(function(e){return l.Error(e)}),a.scrollTo(0,0))}),s.AccountAssetCert().then(function(e){void 0!==e.success&&e.success?(null!=e.data.result.assetcerts?t.myCerts=e.data.result.assetcerts:t.myCerts=[],t.myCertsLoaded=!0):(n("MESSAGES.CANT_LOAD_MY_CERTS").then(function(e){return l.Error(e)}),a.scrollTo(0,0))})}function E(e,s,t,r,n,a,o,l,c){r.allDids=[],r.loaded=!1,s.ListAllDids().then(function(e){void 0!==e.success&&e.success?r.allDids=e.data.result.dids:(n("MESSAGES.CANT_LOAD_ALL_DIDS").then(function(e){return o.Error(e)}),a.scrollTo(0,0)),r.loaded=!0})}function A(e,r,t,n,a,s,o,l,c,i,d){function u(){for(var e in n.error)if(n.error[e])return void(n.submittable=!1);n.submittable=!0}n.listAddresses=[],n.listMultiSig=[],n.createProfile=function(e,s,t){NProgress.start(),r.RegisterDid(e,s,t).then(function(s){void 0!==s.success&&s.success?s.data.result.transaction?(a("MESSAGES.DID_CREATED").then(function(e){return o.Success(e,!0,s.data.result.transaction.hash)}),c.path("/avatar/myavatars/")):(a("MESSAGES.MULTISIGNATURE_SUCCESS").then(function(e){return o.Success(e)}),n.resultMultisigTx=s.data.result):a("MESSAGES.ERROR_DID_CREATION").then(function(e){null!=s.message.message?o.Error(e+" : "+s.message.message):o.Error(e)}),NProgress.done(),n.password=""})},n.popupIssueDid=function(e){t.get("credentials").password!=e?(a("MESSAGES.WRONG_PASSWORD").then(function(e){return o.Error(e)}),s.scrollTo(0,0)):l.open({template:"issueDid",scope:n})},n.error=[],n.didAddress="",n.confirmation=!1,n.checkInputs=function(e){n.confirmation=!0,delete i.flash},n.allDids=[],n.allDidsSymbols=[],n.allDidsAddresses=[],n.didAddress="",n.addresses=[],n.resultMultisigTx="",n.resultMultisigTxSaved=!1,NProgress.start(),r.ListBalances().then(function(e){void 0!==e.success&&e.success&&(n.addresses=[],e.data.balances.forEach(function(e){var s="New address";null!=t.get(e.balance.address)&&(s=t.get(e.balance.address)),n.addresses[e.balance.address]={balance:parseInt(e.balance.unspent),available:parseInt(e.balance.available),address:e.balance.address,name:s,frozen:e.balance.frozen,type:"single"},n.listAddresses.push({balance:parseInt(e.balance.unspent),available:parseInt(e.balance.available),address:e.balance.address})}))}),NProgress.done(),r.ListAllDids().then(function(e){void 0!==e.success&&e.success?(n.allDids=e.data.result.dids,void 0!==n.allDids&&null!=n.allDids?n.allDids.forEach(function(e){n.allDidsSymbols.push(e.symbol),n.allDidsAddresses.push(e.address)}):n.allDids=[]):(a("MESSAGES.CANT_LOAD_ALL_DIDS").then(function(e){return o.Error(e)}),s.scrollTo(0,0))}),n.closeAll=function(){l.closeAll()},n.$watch("didSymbol",function(e,s){n.error.symbol_empty=null==e,n.error.symbol_wrong_char=null!=e&&!e.match(/^[0-9A-Za-z.@_-]+$/),n.error.symbol_already_exist=null!=e&&-1<n.allDidsSymbols.indexOf(e),u()}),n.$watch("didAddress",function(e,s){n.error.didAddress_empty=null==e||""==e,n.error.didAddress_already_used=null!=e&&-1<n.allDidsAddresses.indexOf(e),n.error.didAddress_not_enough_etp=null!=e&&null!=n.addresses[e]&&n.addresses[e].available<1,u()}),n.$watch("password",function(e,s){n.errorPassword=null==e||""==e})}function y(e,a,o,l,c,i,d,s,u,t,m){function r(){for(var e in l.error)if(l.error[e])return void(l.submittable=!1);l.submittable=!0}l.listAddresses=[],l.listMultiSig=[],l.modifyAddress=function(e,s,t,r){if(o.get("credentials").password!=r)c("MESSAGES.WRONG_PASSWORD").then(function(e){return d.Error(e)}),i.scrollTo(0,0);else{NProgress.start();var n=m("convertfortx")(t,8);a.DidChangeAddress(e,s,n,r).then(function(s){void 0!==s.success&&s.success?s.data.result.transaction?(c("MESSAGES.DID_ADDRESS_UPDATED").then(function(e){return d.Success(e,!0,s.data.result.transaction.hash)}),u.path("/avatar/myavatars/")):(c("MESSAGES.MULTISIGNATURE_SUCCESS").then(function(e){return d.Success(e)}),l.resultMultisigTx=s.data.result):c("MESSAGES.ERROR_DID_MODIFY_ADDRESS").then(function(e){null!=s.message.message?d.Error(e+" : "+s.message.message):d.Error(e)}),NProgress.done(),l.password=""})}},l.error=[],l.confirmation=!1,l.checkInputs=function(e){l.confirmation=!0,delete t.flash},l.selectedDid=u.path().split("/")[3],l.myDidsAddresses=[],l.symbolAddress=[],l.selectedDidAddress="",l.changeDid=function(e){l.selectedDidAddress=l.symbolAddress[e]},l.transactionFee=1e-4,l.resultMultisigTx="",l.resultMultisigTxSaved=!1,NProgress.start(),a.ListBalances().then(function(e){void 0!==e.success&&e.success&&(l.addresses=[],e.data.balances.forEach(function(e){var s="New address";null!=o.get(e.balance.address)&&(s=o.get(e.balance.address)),l.addresses[e.balance.address]={balance:parseInt(e.balance.unspent),available:parseInt(e.balance.available),address:e.balance.address,name:s,frozen:e.balance.frozen,type:"single"},l.listAddresses.push({balance:parseInt(e.balance.unspent),available:parseInt(e.balance.available),address:e.balance.address})}),a.ListMultiSig().then(function(e){void 0!==e.success&&e.success&&""!=e.data.multisig&&e.data.multisig.forEach(function(e){l.addresses[e.address].type="multisig"})}))}),NProgress.done(),a.ListMyDids().then(function(e){void 0!==e.success&&e.success?e.data.result.dids?(l.myDids=e.data.result.dids,void 0!==l.myDids&&null!=l.myDids&&l.myDids.forEach(function(e){l.myDidsAddresses.push(e.address),l.symbolAddress[e.symbol]=e.address,e.symbol==l.selectedDid&&(l.selectedDidAddress=e.address)})):(l.noDids=!0,l.selectedDid=""):(c("MESSAGES.CANT_LOAD_MY_DIDS").then(function(e){return d.Error(e)}),i.scrollTo(0,0))}),l.$watch("selectedDid",function(e,s){l.error.selectedDid=null==e||""==e,r()}),l.$watch("toAddress",function(e,s){l.error.toAddress_empty=null==e||""==e,l.error.toAddress_already_used=null!=e&&-1<l.myDidsAddresses.indexOf(e),l.error.toAddress_not_enough_balance=null!=e&&l.addresses[e].available<1,r()}),l.$watch("transactionFee",function(e,s){l.error.fee_empty=null==e,l.error.fee_too_low=null!=e&&e<1e-4,r()}),l.$watch("password",function(e,s){l.errorPassword=null==e||""==e})}function b(e,o,l,c,s,i,d,u,m,f){function t(e){l.certSymbol=e.split(":")[0],l.certType=e.split(":")[1]}function r(){o.AccountAssetCert().then(function(e){void 0!==e.success&&e.success?(null!=e.data.result.assetcerts&&""!=e.data.result.assetcerts?(l.myCerts=e.data.result.assetcerts,l.myCerts.forEach(function(e){l.certs[e.symbol]=e})):(l.myCerts=[],l.noCerts=!0),l.myCertsLoaded=!0):(d("MESSAGES.CANT_LOAD_MY_CERTS").then(function(e){return f.Error(e)}),u.scrollTo(0,0))})}function n(){for(var e in l.error)if(l.error[e])return void(l.submittable=!1);l.submittable=!0}l.listAddresses=[],l.listMultiSig=[],l.myDids=[],l.myCerts=[],l.certs=[],l.noCerts=!1,l.error=[],l.changeSymbol=t,l.transactionFee=1e-4,l.allDidsAddresses=[],l.listMyCerts=r,l.checkInputs=function(){l.confirmation=!0,delete s.flash},l.transferCert=function(e,s,t,r,n){if(m.get("credentials").password!=n)d("MESSAGES.WRONG_PASSWORD").then(function(e){return f.Error(e)}),u.scrollTo(0,0);else{var a=c("convertfortx")(r,8);NProgress.start(),o.TransferCert(e,s,t,a,n).then(function(s){void 0!==s.success&&s.success&&s.data.result.transaction?(d("MESSAGES.CERT_TRANSFERED").then(function(e){return f.Success(e,!0,s.data.result.transaction.hash)}),i.path("/avatar/myavatars/")):d("MESSAGES.ERROR_CERT_TRANSFERED").then(function(e){null!=s.message.message?f.Error(e+" : "+s.message.message):f.Error(e)}),NProgress.done(),l.password=""})}},l.myCertsLoaded=!1,l.allDidsSymbols=[],l.onChain=!0,l.selectedCert=i.path().split("/")[3],t(l.selectedCert),NProgress.start(),o.ListBalances().then(function(e){void 0!==e.success&&e.success&&(l.addresses=[],e.data.balances.forEach(function(e){var s="New address";null!=m.get(e.balance.address)&&(s=m.get(e.balance.address)),l.addresses[e.balance.address]={balance:parseInt(e.balance.unspent),available:parseInt(e.balance.available),address:e.balance.address,name:s,frozen:e.balance.frozen,type:"single"},l.listAddresses.push({balance:parseInt(e.balance.unspent),available:parseInt(e.balance.available),address:e.balance.address})}),o.ListMultiSig().then(function(e){void 0!==e.success&&e.success&&""!=e.data.multisig&&e.data.multisig.forEach(function(e){l.addresses[e.address].type="multisig";var s="New address";null!=m.get(e.address)&&(s=m.get(e.address)),l.listMultiSig.push({index:e.index,m:e.m,n:e.n,selfpublickey:e["self-publickey"],description:e.description,address:e.address,name:s,balance:l.addresses[e.address].balance,available:l.addresses[e.address].available,publicKeys:e["public-keys"]})})}))}),NProgress.done(),o.ListAllDids().then(function(e){void 0!==e.success&&e.success?(l.allDids=e.data.result.dids,l.allDidsSymbols=[],void 0!==l.allDids&&null!=l.allDids?l.allDids.forEach(function(e){l.allDidsSymbols.push(e.symbol)}):l.allDids=[]):(d("MESSAGES.CANT_LOAD_ALL_DIDS").then(function(e){return f.Error(e)}),u.scrollTo(0,0)),r()}),l.$watch("certSymbol",function(e,s){l.error.certSymbol=null==e||""==e,n()}),l.$watch("certType",function(e,s){l.error.certType=null==e||""==e,n()}),l.$watch("toDID",function(e,s){l.error.toDID_empty=null==e||""==e,l.error.toDID_not_exist=null!=e&&null!=l.allDidsSymbols&&!(-1<l.allDidsSymbols.indexOf(e)),n()}),l.$watch("transactionFee",function(e,s){l.error.fee_empty=null==e,l.error.fee_too_low=null!=e&&e<1e-4,n()}),l.$watch("password",function(e,s){l.errorPassword=null==e||""==e})}function _(e,o,l,c,s,i,d,u,m,f){function t(){o.AccountAssetCert().then(function(e){void 0!==e.success&&e.success?(null!=e.data.result.assetcerts&&""!=e.data.result.assetcerts?(l.myCerts=e.data.result.assetcerts,l.myCerts.forEach(function(e){(l.certs[e.symbol]=e).symbol==l.certSymbol&&(l.certType=e.certs)})):l.myCerts=[],l.myCertsLoaded=!0):(d("MESSAGES.CANT_LOAD_MY_CERTS").then(function(e){return f.Error(e)}),u.scrollTo(0,0))})}function r(){for(var e in l.error)if(l.error[e])return void(l.submittable=!1);l.submittable=!0}l.listAddresses=[],l.listMultiSig=[],l.myDids=[],l.myCerts=[],l.certs=[],l.error=[],l.warning=[],l.certType="",l.changeDomain=function(e){l.symbol=e+"."},l.transactionFee=1e-4,l.allDidsAddresses=[],l.listMyCerts=t,l.checkInputs=function(e){l.symbol=c("uppercase")(l.symbol),l.confirmation=!0,delete s.flash},l.issueCert=function(e,s,t,r,n){if(m.get("credentials").password!=n)d("MESSAGES.WRONG_PASSWORD").then(function(e){return f.Error(e)}),u.scrollTo(0,0);else{var a=c("convertfortx")(r,8);NProgress.start(),o.IssueCert(e,"naming",s,t,a,n).then(function(s){void 0!==s.success&&s.success?(d("MESSAGES.CERT_ISSUED").then(function(e){return f.Success(e,!0,s.data.result.transaction.hash)}),i.path("/avatar/myavatars/")):d("MESSAGES.ERROR_CERT_ISSUE").then(function(e){null!=s.message.message?f.Error(e+" : "+s.message.message):f.Error(e)}),NProgress.done(),l.password=""})}},l.myCertsLoaded=!1,l.symbol="",l.assets=[],l.listAllAssets=[],l.onChain=!0,l.domain=c("uppercase")(i.path().split("/")[3]),NProgress.start(),o.ListBalances().then(function(e){void 0!==e.success&&e.success&&(l.addresses=[],e.data.balances.forEach(function(e){var s="New address";null!=m.get(e.balance.address)&&(s=m.get(e.balance.address)),l.addresses[e.balance.address]={balance:parseInt(e.balance.unspent),available:parseInt(e.balance.available),address:e.balance.address,name:s,frozen:e.balance.frozen,type:"single"},l.listAddresses.push({balance:parseInt(e.balance.unspent),available:parseInt(e.balance.available),address:e.balance.address})}),o.ListMultiSig().then(function(e){void 0!==e.success&&e.success&&""!=e.data.multisig&&e.data.multisig.forEach(function(e){l.addresses[e.address].type="multisig";var s="New address";null!=m.get(e.address)&&(s=m.get(e.address)),l.listMultiSig.push({index:e.index,m:e.m,n:e.n,selfpublickey:e["self-publickey"],description:e.description,address:e.address,name:s,balance:l.addresses[e.address].balance,available:l.addresses[e.address].available,publicKeys:e["public-keys"]})})}))}),NProgress.done(),o.ListAllAssets().then(function(e){void 0!==e.success&&e.success&&(l.assets=e.data.assets,""!=l.assets&&l.assets.forEach(function(e){l.listAllAssets.push(e.symbol)}))}),o.ListAllDids().then(function(e){void 0!==e.success&&e.success?(l.allDids=e.data.result.dids,l.allDidsSymbols=[],void 0!==l.allDids&&null!=l.allDids?l.allDids.forEach(function(e){l.allDidsSymbols.push(e.symbol)}):l.allDids=[]):(d("MESSAGES.CANT_LOAD_ALL_DIDS").then(function(e){return f.Error(e)}),u.scrollTo(0,0)),t()}),l.$watch("domain",function(e,s){l.error.domain_empty=null==e||""==e,r()}),l.$watch("symbol",function(e,s){l.error.symbol_empty=null==e||""==e,l.error.symbol_not_under_my_domain=null!=e&&null!=l.domain&&!c("uppercase")(e).startsWith(l.domain+"."),l.error.symbol_wrong_char=null!=e&&""!=e&&!e.match(/^[0-9A-Za-z.]+$/),l.error.symbol_already_exist=null!=e&&-1<l.listAllAssets.indexOf(c("uppercase")(e)),l.warning.symbol_end_dot=null!=e&&"."==e.charAt(e.length-1),r()}),l.$watch("toDID",function(e,s){l.error.toDID_empty=null==e||""==e,l.error.toDID_not_exist=null!=e&&!(-1<l.allDidsSymbols.indexOf(e)),r()}),l.$watch("transactionFee",function(e,s){l.error.fee_empty=null==e,l.error.fee_too_low=null!=e&&e<1e-4,r()}),l.$watch("password",function(e,s){l.errorPassword=null==e||""==e})}function w(e,s,t,r,n,a,o){t.loaded=!1,t.mymits=[],NProgress.start(),s.ListMITs().then(function(e){void 0!==e.success&&e.success?t.mymits=null!=e.data.result.mits?e.data.result.mits:[]:r("MESSAGES.MITS_LOAD_ERROR").then(function(e){return o.Error(e)}),t.loaded=!0,NProgress.done()})}function D(e,t,r,n,a,s,o,l,c,i,d){function u(){n.mitSymbol="",n.mitAvatar="",n.content="",n.password="",n.transactionFee=1e-4,n.confirmation=!1,n.submittable=!1}function m(){for(var e in n.error)if(n.error[e])return void(n.submittable=!1);n.submittable=!0}n.listAddresses=[],n.registerMIT=function(e){NProgress.start();var s=d("convertfortx")(n.transactionFee,8);t.RegisterMIT(n.mitSymbol,n.mitAvatar,n.content,s,e).then(function(s){void 0!==s.success&&s.success?s.data.result.transaction&&(a("MESSAGES.MIT_CREATED").then(function(e){return o.Success(e,!0,s.data.result.transaction.hash)}),u()):a("MESSAGES.ERROR_MIT_CREATION").then(function(e){null!=s.message.message?o.Error(e+" : "+s.message.message):o.Error(e)}),NProgress.done(),n.password=""})},n.error=[],n.checkInputs=function(e){n.confirmation=!0,delete i.flash},n.addresses=[],n.myDidsAddresses=[],n.symbolAddress=[],n.noDids=!1,NProgress.start(),t.ListBalances().then(function(e){void 0!==e.success&&e.success&&(n.addresses=[],e.data.balances.forEach(function(e){var s="New address";null!=r.get(e.balance.address)&&(s=r.get(e.balance.address)),n.addresses[e.balance.address]={balance:parseInt(e.balance.unspent),available:parseInt(e.balance.available),address:e.balance.address,name:s,frozen:e.balance.frozen},n.listAddresses.push({balance:parseInt(e.balance.unspent),available:parseInt(e.balance.available),address:e.balance.address})}))}),NProgress.done(),t.ListMyDids().then(function(e){void 0!==e.success&&e.success?e.data.result.dids?(n.myDids=e.data.result.dids,void 0!==n.myDids&&null!=n.myDids&&n.myDids.forEach(function(e){n.myDidsAddresses.push(e.address),n.symbolAddress[e.symbol]=e.address})):(n.noDids=!0,n.selectedDid=""):(a("MESSAGES.CANT_LOAD_MY_DIDS").then(function(e){return o.Error(e)}),s.scrollTo(0,0))}),n.closeAll=function(){l.closeAll()},n.$watch("mitSymbol",function(e,s){n.error.symbol_empty=null==e||""==e,n.error.symbol_wrong_char=null!=e&&""!=e&&!e.match(/^[0-9A-Za-z.@_-]+$/),m()}),n.$watch("mitAvatar",function(e,s){n.error.mitAvatar_empty=null==e||""==e,n.error.mitAvatar_not_enough_etp=null!=e&&null!=n.addresses[e]&&n.addresses[e].available<1e-4,m()}),n.$watch("transactionFee",function(e,s){n.error.fee_empty=null==e,n.error.fee_too_low=null!=e&&e<1e-4,m()}),n.$watch("password",function(e,s){n.errorPassword=null==e||""==e}),u()}function T(e,t,s,r,n,a,o,l,c,i,d){function u(){r.sendto="",r.password="",r.transactionFee=1e-4,r.confirmation=!1,r.submittable=!1}function m(){for(var e in r.error)if(r.error[e])return void(r.submittable=!1);r.submittable=!0}r.transferMIT=function(e){NProgress.start();var s=d("convertfortx")(r.transactionFee,8);t.TransferMIT(r.mitSymbol,r.sendto,s,e).then(function(s){void 0!==s.success&&s.success?s.data.result.transaction&&(n("MESSAGES.MIT_CREATED").then(function(e){return o.Success(e,!0,s.data.result.transaction.hash)}),u()):n("MESSAGES.ERROR_MIT_CREATION").then(function(e){null!=s.message.message?o.Error(e+" : "+s.message.message):o.Error(e)}),NProgress.done(),r.password=""})},r.error=[],r.checkInputs=function(e){r.confirmation=!0,delete i.flash},r.mymits=[],r.allDidsSymbols=[],r.loaded=!1,r.mitSymbol=c.path().split("/")[3],NProgress.start(),t.ListMITs().then(function(e){void 0!==e.success&&e.success?r.mymits=null!=e.data.result.mits?e.data.result.mits:[]:n("MESSAGES.MITS_LOAD_ERROR").then(function(e){return o.Error(e)}),r.loaded=!0,NProgress.done()}),t.ListAllDids().then(function(e){void 0!==e.success&&e.success?(r.allDids=e.data.result.dids,void 0!==r.allDids&&null!=r.allDids&&r.allDids.forEach(function(e){r.allDidsSymbols.push(e.symbol)})):(n("MESSAGES.CANT_LOAD_ALL_DIDS").then(function(e){return o.Error(e)}),a.scrollTo(0,0))}),r.closeAll=function(){l.closeAll()},r.$watch("mitSymbol",function(e,s){r.error.mitSymbol_empty=null==e||""==e,m()}),r.$watch("sendto",function(e,s){r.error.sendto_empty=null==e||""==e,r.error.sendto_not_exist=null!=e&&""!=e&&!(-1<r.allDidsSymbols.indexOf(e)),m()}),r.$watch("transactionFee",function(e,s){r.error.fee_empty=null==e,r.error.fee_too_low=null!=e&&e<1e-4,m()}),r.$watch("password",function(e,s){r.errorPassword=null==e||""==e}),u()}g.$inject=["MetaverseService","$rootScope","$scope","localStorageService","$interval","$translate","$location","$filter","$http","FlashService"],e.$inject=["$location","$rootScope"],S.$inject=["MetaverseService","$rootScope","FlashService","$translate","$scope","$window"],l.$inject=["MetaverseHelperService","MetaverseService","$translate","$rootScope","$scope","FlashService","$location","localStorageService","$window"],c.$inject=["MetaverseService","$translate","$rootScope","$scope","$http","FlashService","$location","localStorageService","$window","FileSaver","Blob"],i.$inject=["MetaverseService","$stateParams","$rootScope","$scope","$translate","$location","localStorageService","FlashService","$window","$filter"],h.$inject=["MetaverseService","$rootScope","$scope","FlashService","localStorageService","$location","$translate","$window","ngDialog","$filter"],f.$inject=["MetaverseService","$rootScope","$scope","$location","localStorageService","FlashService","$translate","$window","ngDialog","$filter"],p.$inject=["MetaverseHelperService","MetaverseService","$rootScope","$scope","$location","$translate","FlashService","$window"],u.$inject=["MetaverseService","$rootScope","$scope","localStorageService","FlashService","$translate","$stateParams","$location","$window","ngDialog","$filter"],m.$inject=["MetaverseService","$rootScope","$scope","localStorageService","FlashService","$translate","$stateParams","$location","$window","ngDialog","$filter"],d.$inject=["MetaverseService","$rootScope","$scope","$location","FlashService","$translate","$stateParams","$window"],r.$inject=["MetaverseService","MetaverseHelperService","$rootScope","$scope","FlashService","localStorageService","$translate","$window","$filter"],n.$inject=["MetaverseService","MetaverseHelperService","$filter","$location","$rootScope","$scope","FlashService","localStorageService","$translate","$window"],a.$inject=["MetaverseService","MetaverseHelperService","$location","$filter","$rootScope","$scope","FlashService","localStorageService","$translate","$window"],o.$inject=["MetaverseService","MetaverseHelperService","$filter","$rootScope","$scope","FlashService","localStorageService","$translate","$window"],t.$inject=["MetaverseService","MetaverseHelperService","$rootScope","$scope","FlashService","localStorageService","$translate","$window","$location","$filter"],s.$inject=["MetaverseService","MetaverseHelperService","$location","$stateParams","$rootScope","$scope","FlashService","localStorageService","$translate","$window"],v.$inject=["MetaverseHelperService","MetaverseService","$scope","$location","$translate","$window","localStorageService","FlashService"],A.$inject=["MetaverseHelperService","MetaverseService","localStorageService","$scope","$translate","$window","FlashService","ngDialog","$location","$rootScope","$filter"],E.$inject=["MetaverseHelperService","MetaverseService","localStorageService","$scope","$translate","$window","FlashService","ngDialog","$location"],y.$inject=["MetaverseHelperService","MetaverseService","localStorageService","$scope","$translate","$window","FlashService","ngDialog","$location","$rootScope","$filter"],b.$inject=["MetaverseHelperService","MetaverseService","$scope","$filter","$rootScope","$location","$translate","$window","localStorageService","FlashService"],_.$inject=["MetaverseHelperService","MetaverseService","$scope","$filter","$rootScope","$location","$translate","$window","localStorageService","FlashService"],w.$inject=["MetaverseHelperService","MetaverseService","$scope","$translate","$window","localStorageService","FlashService"],D.$inject=["MetaverseHelperService","MetaverseService","localStorageService","$scope","$translate","$window","FlashService","ngDialog","$location","$rootScope","$filter"],T.$inject=["MetaverseHelperService","MetaverseService","localStorageService","$scope","$translate","$window","FlashService","ngDialog","$location","$rootScope","$filter"],angular.module("app").controller("HomeController",g).controller("MenuController",e).controller("ConsoleController",S).controller("AddressesController",l).controller("AccountController",c).controller("TransferAssetController",i).controller("CreateAssetController",h).controller("AssetSecondaryIssueController",f).controller("AssetsController",p).controller("ShowAssetsController",u).controller("AssetDetailController",m).controller("ShowAllAssetsController",d).controller("ETPController",r).controller("SignMultiSignController",n).controller("TransferMultiSignController",a).controller("NewMultiSignController",o).controller("DepositController",t).controller("ExplorerController",s).controller("ProfileController",v).controller("CreateProfileController",A).controller("AllProfilesController",E).controller("ModifyAddressController",y).controller("TransferCertController",b).controller("IssueCertController",_).controller("ShowMITsController",w).controller("CreateMITController",D).controller("TransferMITController",T).directive("bsTooltip",function(){return{restrict:"A",link:function(e,s,t){$(s).hover(function(){$(s).tooltip("show")},function(){$(s).tooltip("hide")})}}}).directive("z",["$compile","$timeout",function(e,s){return function(e,s){$(s).popover(),$("body").on("click",function(e){"popover"!==$(e.target).data("toggle")&&0===$(e.target).parents(".popover.in").length&&$(s).popover("hide")})}}]).directive("fileread",[function(){return{scope:{fileread:"="},link:function(t,e,s){e.bind("change",function(e){var s=new FileReader;s.onload=function(e){t.$apply(function(){t.fileread=e.target.result})},s.readAsText(e.target.files[0])})}}}]).directive("checkImage",function(){return{link:function(e,s,t){s.bind("error",function(){s.attr("src","icon/default.png")})}}}).filter("convertfortx",function(){return function(e,s){return void 0===s&&(s=8),bigDecimal.multiply(e,Math.pow(10,s))}}).filter("converttodisplay",function(){return function(e,s){return void 0===s&&(s=8),bigDecimal.divide(e,Math.pow(10,s))}})}(),function(){function e(s,e,t,r,n,a,o,l,c){var i=this;function d(){var e="testnet"==t.network?"https://explorer-testnet.mvs.org/api/height":"https://explorer.mvs.org/api/height";c.get(e).then(function(e){i.popoverSynchShown||($(function(){$(".popover-show").popover("show")}),i.popoverSynchShown=!0),i.heightFromExplorer=e.data.result,i.loadingPercent=Math.floor(i.height/i.heightFromExplorer*100)}).catch(function(e){return console.log("Cannot get Height from explorer")})}function u(){i.getHeightFromExplorer(),e.GetInfo().then(function(e){void 0!==e.success&&e.success&&(i.height=e.data.height,i.loadingPercent=Math.floor(i.height/i.heightFromExplorer*100),i.peers=e.data.peers)})}i.login=function(){NProgress.start(),e.CheckAccount(i.username,i.password).then(function(e){void 0!==e.success&&e.success&&null!=e.data?(n.set("credentials",{user:i.username,password:i.password}),setTimeout(function(){return NProgress.done()},500),s.path("/home")):(setTimeout(function(){return NProgress.done()},1e3),o("MESSAGES.LOGIN_WRONG_CREDENTIALS").then(function(e){return r.Error(e)}),l.scrollTo(0,0))}).catch(function(){setTimeout(function(){return NProgress.done()},500),o("MESSAGES.GENERAL_CONNECTION_ERROR").then(function(e){return r.Error(e)}),l.scrollTo(0,0)})},n.remove("credentials"),i.changeLang=function(e){return o.use(e).then(function(e){return n.set("language",e)}).catch(function(e){return console.log("Cannot change language.")})},i.height="",i.getHeightFromExplorer=d,i.heightFromExplorer=0,i.loadingPercent=0,i.popoverSynchShown=!1,i.version="",i.peers="",e.GetInfoV2().then(function(e){void 0!==e.success&&e.success&&(i.height=e.data.result.height,t.network=e.data.result.testnet?"testnet":"mainnet",i.version=e.data.result["wallet-version"],i.peers=e.data.result.peers)}).then(function(){return d()}).then(function(){return i.loadingPercent=Math.floor(i.height/i.heightFromExplorer*100)}),u(),a(function(){return u()},1e4)}angular.module("app").controller("LoginController",e),e.$inject=["$location","MetaverseService","$rootScope","FlashService","localStorageService","$interval","$translate","$window","$http"]}(),function(){function e(e,S){var r={},s=window.location.hostname+":8820",t=window.location.hostname+":8821",n=window.location.protocol+"/rpc",a=window.location.protocol+"/rpc/v2";return r.debug=!1,r.MetaverseNetwork={mainnet:{messagePrefix:"Bitcoin Signed Message:\n",bech32:"bc",bip32:{public:76067358,private:76066276},pubKeyHash:50,scriptHash:5,locktimes:[25200,108e3,331200,655200,1314e3],wif:128},testnet:{messagePrefix:"Bitcoin Signed Message:\n",bech32:"tb",bip32:{public:70617039,private:70615956},pubKeyHash:127,scriptHash:196,locktimes:[10,20,30,40,50],wif:239}},r.hasIcon=["ETP","MVS.ZGC","MVS.ZDC","CSD.CSD","PARCELX.GPX","PARCELX.TEST","SDG","META","MVS.HUG"],r.burnAddress="1111111111111111111114oLvT2",r.burnAddress_short="blackhole",r.CheckAccount=function(e,s){return o("getbalance",[e,s])},r.GetNewAccount=function(e,s){return o("getnewaccount",[e,s])},r.ImportAccount=function(e,s,t,r){return o("importaccount",["-n",e,"-p",s,"-i",r,t])},r.GetBalance=function(){var e=S.get("credentials");return o("getbalance",[e.user,e.password])},r.ListAddresses=function(){var e=S.get("credentials");return o("listaddresses",[e.user,e.password])},r.ListBalances=function(e){var s=S.get("credentials");return o("listbalances",e?["-n",s.user,s.password]:[s.user,s.password])},r.GetAccount=function(e){var s=S.get("credentials");return o("getaccount",[s.user,s.password,e])},r.GetNewAddress=function(){var e=S.get("credentials");return o("getnewaddress",[e.user,e.password])},r.ChangePassword=function(e){var s=S.get("credentials");return o("changepasswd",[s.user,s.password,"--password",e])},r.ResetPassword=function(e,s,t){return o("changepasswdext",["-n",e,"-p",s,t])},r.DumpKeyFile=function(e,s){return g("dumpkeyfile",[S.get("credentials").user,e,s,"-d"])},r.ImportKeyFile=function(e,s,t,r){return o("importkeyfile",[e,s,t,r])},r.SERVER=s,r.SERVER2=t,r.Start=function(){var e=S.get("credentials");return o("start",[e.user,e.password])},r.Stop=function(){var e=S.get("credentials");return o("stop",[e.user,e.password])},r.GetMiningInfo=function(){var e=S.get("credentials");return o("getmininginfo",[e.user,e.password])},r.Send=function(e,s,t,r,n){var a=S.get("credentials");return g("send",""==r?[a.user,n,e,s,"-f",t]:[a.user,n,e,s,"-f",t,"-m",r])},r.SendFrom=function(e,s,t,r,n,a){var o=S.get("credentials");return g("sendfrom",""==n?[o.user,a,e,s,t,"-f",r]:[o.user,a,e,s,t,"-f",r,"-m",n])},r.SendMore=function(e,s,t){var r=S.get("credentials"),n=[],a="";return n.push(r.user),n.push(t),n.push("-f"),n.push(s),e.forEach(function(e){a=e.address+":"+e.value,n.push("-r"),n.push(a)}),g("sendmore",n)},r.ListTxs=function(e){var s=S.get("credentials");return o("listtxs",["-i",e,s.user,s.password])},r.GetPublicKey=function(e){var s=S.get("credentials");return o("getpublickey",[s.user,s.password,e])},r.GetNewMultiSig=function(e,s,t,r){var n=S.get("credentials"),a=[];return a.push("-m"),a.push(e),a.push("-n"),a.push(s),a.push("-s"),a.push(t),r.forEach(function(e){a.push("-k"),a.push(e.publicKey)}),a.push(n.user),a.push(n.password),g("getnewmultisig",a)},r.ListMultiSig=function(){var e=S.get("credentials");return o("listmultisig",[e.user,e.password])},r.CreateMultisigTx=function(e,s,t,r,n){return g("createmultisigtx",[S.get("credentials").user,n,e,s,t,"-f",r])},r.SignMultisigTx=function(e,s,t){var r=S.get("credentials");return g("signmultisigtx",t?[r.user,s,e,"-b"]:[r.user,s,e])},r.CreateAsset=function(e,s,t,r,n,a,o){var l=S.get("credentials");return g("createasset",[l.user,l.password,"-s",e,"-i",s,"-v",t,"-n",n,"-d",a,"-r",o])},r.ListAssets=function(){var e=S.get("credentials");return o("listassets",[e.user,e.password])},r.ListAllAssets=function(){return o("listassets")},r.GetAsset=function(e){return o("getasset",[e])},r.GetAddressAsset=function(e){return o("getaddressasset",[e])},r.Issue=function(e){var s=S.get("credentials");return g("issue",[s.user,s.password,e])},r.Delete=function(e){var s=S.get("credentials");return o("deletelocalasset",["-s",e,s.user,s.password])},r.GetAccountAsset=function(e){var s=S.get("credentials");return g("getaccountasset",[s.user,s.password,e])},r.SecondaryIssue=function(e,s,t,r,n,a,o,l,c,i,d){var u=S.get("credentials");switch(r){case"1":var m="TYPE=1;LQ="+a+";LP="+o+";UN="+n;return g("secondaryissue",[u.user,d,e,s,t,"-m",m,"-f",i]);case"2":var u=S.get("credentials"),f="",h="";l.forEach(function(e){f+=e.number,f+=",",h+=e.quantityToSend,h+=","}),f=f.substring(0,f.length-1),h=h.substring(0,h.length-1);var m="TYPE=2;LQ="+a+";LP="+o+";UN="+n+";UC="+f+";UQ="+h;return g("secondaryissue",[u.user,d,e,s,t,"-m",m,"-f",i]);case"3":var m="TYPE=3;LQ="+a+";LP="+o+";UN="+n+";IR="+c;return g("secondaryissue",[u.user,d,e,s,t,"-f",i,"-m",m]);default:return g("secondaryissue",[u.user,d,e,s,t,"-f",i])}},r.CreateAssetMultisigTx=function(e,s,t,r,n,a){return g("createmultisigtx",[S.get("credentials").user,a,s,t,r,"-t","3","-s",e,"-f",n])},r.ListMITs=function(){var e=S.get("credentials");return g("listmits",[e.user,e.password])},r.RegisterMIT=function(e,s,t,r,n){return g("registermit",[S.get("credentials").user,n,s,e,"-c",t,"-f",r])},r.TransferMIT=function(e,s,t,r){return g("transfermit",[S.get("credentials").user,r,s,e,"-f",t])},r.FetchHeight=function(){return o("fetch-height",[])},r.FetchTx=function(e){return o("fetch-tx",[e])},r.FetchHeader=function(e){return o("fetch-header",["-t",e])},r.GetBlock=function(e){return o("getblock",[e,"--json=true"])},r.ListTxsAddress=function(e,s){var t=S.get("credentials");return o("listtxs",[t.user,t.password,"-a",e,"-i",s])},r.Query=function(e){var s=e,t=[];0<=e.indexOf(" ")&&(s=e.split(" ")[0],t=e.substring(e.indexOf(s)+s.length+1).replace(/\s{2,}/g," ").split(" "));return o(s,t)},r.Deposit=function(e,s,t,r,n){var a=S.get("credentials");return g("deposit",null!=n?["-d",e,"-a",n,"-f",t,a.user,r,s]:["-d",e,"-f",t,a.user,r,s])},r.FrozenAsset=function(e,s,t,r,n){var a=S.get("credentials");return e*=86400,o("frozenasset",null!=n?["-d",n,a.user,t,r,s,e]:[a.user,t,r,s,e])},r.GetInfo=function(){return o("getinfo",[])},r.GetInfoV2=function(){return g("getinfo",[])},r.RegisterDid=function(e,s,t){return g("registerdid",[S.get("credentials").user,t,e,s])},r.ListMyDids=function(){var e=S.get("credentials");return g("listdids",[e.user,e.password])},r.ListAllDids=function(){return g("listdids",[])},r.DidSendFrom=function(e,s,t,r,n,a){var o=S.get("credentials");return g("didsendfrom",""==n?[o.user,a,e,s,t,"-f",r]:[o.user,a,e,s,t,"-f",r,"-m",n])},r.DidSend=function(e,s,t,r,n){var a=S.get("credentials");return g("didsend",""==r?[a.user,n,e,s,"-f",t]:[a.user,n,e,s,"-f",t,"-m",r])},r.DidSendAssetFrom=function(e,s,t,r,n,a,o,l,c,i,d,u){var m=S.get("credentials");switch(n){case"0":var f="TYPE=1;LQ="+r+";LP="+l+";UN=1";return g("didsendassetfrom",[m.user,u,e,s,t,r,"-f",d,"-m",f]);case"1":var f="TYPE=1;LQ="+o+";LP="+l+";UN="+a;return g("didsendassetfrom",[m.user,u,e,s,t,r,"-f",d,"-m",f]);case"2":var h="",p="";c.forEach(function(e){h+=e.number,h+=",",p+=e.quantityToSend,p+=","}),h=h.substring(0,h.length-1),p=p.substring(0,p.length-1);var f="TYPE=2;LQ="+o+";LP="+l+";UN="+a+";UC="+h+";UQ="+p;return g("didsendassetfrom",[m.user,u,e,s,t,r,"-f",d,"-m",f]);case"3":var f="TYPE=3;LQ="+o+";LP="+l+";UN="+a+";IR="+i;return g("didsendassetfrom",[m.user,u,e,s,t,r,"-f",d,"-m",f]);default:return g("didsendassetfrom",[m.user,u,e,s,t,r,"-f",d])}},r.DidSendAsset=function(e,s,t,r,n,a,o,l,c,i,d){var u=S.get("credentials");switch(r){case"0":var m="TYPE=1;LQ="+t+";LP="+o+";UN=1";return g("didsendasset",[u.user,d,e,s,t,"-f",i,"-m",m]);case"1":var m="TYPE=1;LQ="+a+";LP="+o+";UN="+n;return g("didsendasset",[u.user,d,e,s,t,"-f",i,"-m",m]);case"2":var f="",h="";l.forEach(function(e){f+=e.number,f+=",",h+=e.quantityToSend,h+=","}),f=f.substring(0,f.length-1),h=h.substring(0,h.length-1);var m="TYPE=2;LQ="+a+";LP="+o+";UN="+n+";UC="+f+";UQ="+h;return g("didsendasset",[u.user,d,e,s,t,"-f",i,"-m",m]);case"3":var m="TYPE=3;LQ="+a+";LP="+o+";UN="+n+";IR="+c;return g("didsendassetfrom",[u.user,d,e,s,t,"-f",i,"-m",m]);default:return g("didsendasset",[u.user,d,e,s,t,"-f",i])}},r.DidChangeAddress=function(e,s,t,r){return g("didchangeaddress",[S.get("credentials").user,r,s,e,"-f",t])},r.GetDid=function(e){S.get("credentials");return g("getdid",[e])},r.DidSendMore=function(e,s,t){var r=S.get("credentials"),n=[],a="";return n.push(r.user),n.push(t),n.push("-f"),n.push(s),e.forEach(function(e){a=e.address+":"+e.value,n.push("-r"),n.push(a)}),g("didsendmore",n)},r.AccountAssetCert=function(){var e=S.get("credentials");return g("getaccountasset",[e.user,e.password,"-c"])},r.TransferCert=function(e,s,t,r,n){return g("transfercert",[S.get("credentials").user,n,t,e,s,"-f",r])},r.IssueCert=function(e,s,t,r,n,a){return g("issuecert",[S.get("credentials").user,a,r,t,s,"-f",n])},r;function o(s,t){return e.post(n,{method:s,params:t},{headers:{}}).then(function(e){return r.debug&&console.log({method:s,params:t,result:e.data}),l(e)},function(e){c(e)})}function g(s,t){return e.post(a,{jsonrpc:"2.0",method:s,params:t},{headers:{}}).then(function(e){return r.debug&&console.log({method:s,params:t,result:e.data}),l(e)},function(e){c(e)})}function l(e){return null!=e.data&&null==e.data.error?{success:!0,data:e.data}:c(e)}function c(e){return null!=e.data&&null!=e.data.error?{success:!1,message:e.data.error}:{success:!1,message:"General connection error"}}}function s(r,n){var e={},a="ETP",o="ASSET",l="ISSUE",c="CERT",i="DID_ISSUE",d="DID_TRANSFER",u="MIT",m="UNKNOWN";return e.LoadTransactions=function(s,e,t){r.ListTxs(t).then(function(e){var t=[];"undefined"!==e.success&&e.success?(e.data.current_page==e.data.total_page?t.lastpage=!0:t.lastpage=!1,null==e.data.transactions?(console.log("unable to load transactions."),s(1)):0<e.data.transactions.length?(e.data.transactions.forEach(function(e){var s={height:e.height,hash:e.hash,timestamp:new Date(1e3*e.timestamp),direction:e.direction,recipents:[],value:0,memo:""};switch(function(e){{var s;return null!=e.outputs&&Array.isArray(e.outputs)?(e.outputs.forEach(function(e){"asset-issue"===e.attachment.type&&(s=l),"asset-transfer"===e.attachment.type&&s!=l&&(s=o),"asset-cert"===e.attachment.type&&s!=l&&(s=c),"did-issue"===e.attachment.type&&(s=i),"did-transfer"===e.attachment.type&&(s=d),"mit"===e.attachment.type&&(s=u)}),s||a):m}}(e)){case a:s.type="ETP",s.asset_type=8,s.intrawallet=!0,e.outputs.forEach(function(e){void 0!==e.script&&null!=e.script.match(/\[ (\w+) ] numequalverify dup hash160 \[ (\w+) \] equalverify checksig/)?(s.frozen=!0,s.intrawallet=!1,s.recipents.push({address:e.address,value:parseInt(e["etp-value"]),script:e.script}),s.value+=parseInt(e["etp-value"])):("receive"===s.direction&&"true"===e.own||"send"===s.direction&&"false"===e.own)&&(s.frozen=!1,s.intrawallet=!1,s.recipents.push({address:e.address,value:parseInt(e["etp-value"]),script:e.script}),s.value+=parseInt(e["etp-value"])),void 0!==e.attachment.content&&(s.memo=e.attachment.content)}),s.intrawallet&&(s.direction="intra"),t.push(s);break;case o:s.intrawallet=!0,e.outputs.forEach(function(e){"asset-transfer"===e.attachment.type&&(s.type=e.attachment.symbol,s.decimal_number=e.attachment.decimal_number,("receive"===s.direction&&"true"===e.own||"send"===s.direction&&"false"===e.own)&&(s.intrawallet=!1,s.recipents.push({address:e.address,value:parseInt(e.attachment.quantity)}),s.value+=parseInt(e.attachment.quantity))),void 0!==e.attachment.content&&(s.memo=e.attachment.content)}),s.intrawallet&&(s.direction="intra"),t.push(s);break;case l:s.direction="issue",e.outputs.forEach(function(e){"true"===e.own&&"asset-issue"===e.attachment.type&&(s.recipents.push({address:e.address,value:parseInt(e.attachment.quantity)}),s.value+=parseInt(e.attachment.quantity),s.type=e.attachment.symbol,s.decimal_number=e.attachment.decimal_number),void 0!==e.attachment.content&&(s.memo=e.attachment.content)}),t.push(s);break;case c:s.direction="cert",e.outputs.forEach(function(e){"true"===e.own&&"asset-cert"===e.attachment.type&&(s.recipents.push({address:e.address}),"naming"==e.attachment.certs?s.type=e.attachment.symbol:void 0===s.type&&(s.type=e.attachment.symbol))}),t.push(s);break;case i:s.direction="did-issue",e.outputs.forEach(function(e){"true"===e.own&&"did-issue"===e.attachment.type&&(s.recipents.push({address:e.address}),s.type=e.attachment.symbol)}),t.push(s);break;case d:s.direction="did-transfer",e.outputs.forEach(function(e){"true"===e.own&&"did-transfer"===e.attachment.type&&(s.recipents.push({address:e.address}),s.type=e.attachment.symbol)}),t.push(s);break;case u:e.outputs.forEach(function(e){"mit"===e.attachment.type&&("transfered"==e.attachment.status?s.direction="mit-transfer":s.direction="mit-issue",void 0!==e.attachment.content&&(s.memo=e.attachment.content),s.recipents.push({address:e.address}),s.type=e.attachment.symbol)}),t.push(s)}}),s(null,t)):s(null,[])):(e.error="no record in this page")?s(null,[]):n("MESSAGES.TRANSACTIONS_LOAD_ERROR").then(function(e){s(1,null,e)})})},e.GetBalance=function(t){r.GetBalance().then(function(s){void 0!==s.success&&s.success?n("MESSAGES.GENERAL_CONNECTION_ERROR").then(function(e){t(null,s.data,e)}):n("MESSAGES.GENERAL_CONNECTION_ERROR").then(function(e){t(1,null,e)})})},e}angular.module("app").factory("MetaverseService",e).factory("MetaverseHelperService",s),e.$inject=["$http","localStorageService"],s.$inject=["MetaverseService","$translate"]}(),function(){function e(t,r,e,n,s,a,o,l,c,i){var d=this;function u(){var e="testnet"==a.network?"https://explorer-testnet.mvs.org/api/height":"https://explorer.mvs.org/api/height";i.get(e).then(function(e){d.popoverSynchShown||($(function(){$(".popover-show").popover("show")}),d.popoverSynchShown=!0),d.heightFromExplorer=e.data.result,d.loadingPercent=Math.floor(d.height/d.heightFromExplorer*100)}).catch(function(e){return console.log("Cannot get Height from explorer")})}function m(){d.getHeightFromExplorer(),t.GetInfo().then(function(e){void 0!==e.success&&e.success&&(d.height=e.data.height,d.loadingPercent=Math.floor(d.height/d.heightFromExplorer*100),d.peers=e.data.peers)})}d.buttonCopyToClipboard=new Clipboard(".btn"),d.confirmKey="",d.countWords=function(){""==d.confirmKey?d.countBackupWords=0:(d.confirmKey=d.confirmKey.replace("  "," "),d.confirmKey=d.confirmKey.replace("  "," "),d.countBackupWords=d.confirmKey.split(" ").length)},d.countBackupWords=0,r.new_account=!0,d.register=function(){{if(NProgress.start(),setTimeout(function(){return NProgress.done()},500),!(null!=d.user.username&&""!=d.user.username||r.import_from_file))return l("MESSAGES.NO_ACCOUNTNAME_PROVIDED").then(function(e){return o.Error(e)}),void c.scrollTo(0,0);if(null==d.user.password)return l("MESSAGES.NO_PASSWORD_PROVIDED").then(function(e){return o.Error(e)}),void c.scrollTo(0,0);if(d.user.password.length<6)return l("MESSAGES.PASSWORD_SHORT").then(function(e){return o.Error(e)}),void c.scrollTo(0,0);if(d.user.password_repeat!=d.user.password&&!r.import_from_file&&!r.import_from_phrase)return l("MESSAGES.PASSWORD_NOT_MATCH").then(function(e){return o.Error(e)}),void c.scrollTo(0,0);if(-1!=d.user.username.indexOf(" "))return l("MESSAGES.USERNAME_CONTAINS_SPACE").then(function(e){return o.Error(e)}),void c.scrollTo(0,0);if(-1!=d.user.password.indexOf(" "))return l("MESSAGES.PASSWORD_CONTAINS_SPACE").then(function(e){return o.Error(e)}),void c.scrollTo(0,0)}if(r.import_from_phrase){if(null==r.import_phrase)return l("MESSAGES.NO_PHRASE").then(function(e){return o.Error(e)}),void c.scrollTo(0,0);if(null==r.address_count)return l("MESSAGES.NO_ADDRESS_NBR").then(function(e){return o.Error(e)}),void c.scrollTo(0,0);var e=r.import_phrase.replace(/(\r\n|\n|\r)/gm," "),s=(e=e.replace("  "," ")).match(/[a-z]|[A-Z]| /g);if(e.length!=s.length)return l("MESSAGE.WRONG_PRIVATE_KEY").then(function(e){return o.Error(e)}),void c.scrollTo(0,0);t.ImportAccount(d.user.username,d.user.password,e,r.address_count).then(function(s){void 0!==s.success&&s.success?l("MESSAGES.IMPORT_SUCCESS").then(function(e){o.Success(e,!0),c.scrollTo(0,0),n.path("/login")}):l("MESSAGES.IMPORT_ERROR").then(function(e){null!=s.message?o.Error(e+" "+s.message):o.Error(e),c.scrollTo(0,0)})})}else r.import_from_file?t.ImportKeyFile(d.user.username,d.user.password,".",r.accountInfo).then(function(s){void 0!==s.success&&s.success?l("MESSAGES.IMPORT_SUCCESS").then(function(e){o.Success(e,!0),n.path("/login"),c.scrollTo(0,0)}):l("MESSAGES.IMPORT_ERROR").then(function(e){null!=s.message?o.Error(e+" "+s.message):o.Error(e),c.scrollTo(0,0)})}):t.GetNewAccount(d.user.username,d.user.password).then(function(e){void 0!==e.success&&e.success?(l("MESSAGES.REGISTARTION_SUCCESS").then(function(e){return o.Success(e)}),c.scrollTo(0,0),d.registered={privatekey:e.data.mnemonic,address:e.data["default-address"]}):(o.Error(e.message),c.scrollTo(0,0))})},d.user={username:""},d.changeLang=function(e){return l.use(e).then(function(e){return s.set("language",e)}).catch(function(e){return console.log("Cannot change language.")})},d.height="",d.getHeightFromExplorer=u,d.heightFromExplorer=0,d.loadingPercent=0,d.popoverSynchShown=!1,d.version="",d.peers="",t.GetInfoV2().then(function(e){void 0!==e.success&&e.success&&(d.height=e.data.result.height,a.network=e.data.result.testnet?"testnet":"mainnet",d.version=e.data.result["wallet-version"],d.peers=e.data.result.peers)}).then(function(){return u()}).then(function(){return d.loadingPercent=Math.floor(d.height/d.heightFromExplorer*100)}),m(),e(function(){return m()},1e4)}angular.module("app").controller("RegisterController",e),e.$inject=["MetaverseService","$scope","$interval","$location","localStorageService","$rootScope","FlashService","$translate","$window","$http"]}();