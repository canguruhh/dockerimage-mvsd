"use strict";!function(){function e(e,s){e.state("login",{url:"/login",templateUrl:"login/login.view.0.7.1.html",controller:"LoginController",controllerAs:"vm"}).state("register",{url:"/register",templateUrl:"register/register.view.0.7.1.html",controller:"RegisterController",controllerAs:"vm"}).state("home",{abstract:!0,templateUrl:"home/index.view.0.7.1.html",controller:"HomeController",controllerAs:"vm"}).state("home.account",{abstract:!0,templateUrl:"home/account/index.view.0.7.1.html",controller:"AccountController",controllerAs:"vm"}).state("home.account.details",{url:"/account/details",templateUrl:"home/account/details.view.0.7.1.html",controller:"AccountController",controllerAs:"vm"}).state("home.account.privatekey",{url:"/account/privatekey",templateUrl:"home/account/privatekey.view.0.7.1.html",controller:"AccountController",controllerAs:"vm"}).state("home.account.export",{url:"/account/export",templateUrl:"home/account/export.view.0.7.1.html",controller:"AccountController",controllerAs:"vm"}).state("home.addresses",{templateUrl:"home/addresses/index.view.0.7.1.html",controller:"AddressesController"}).state("home.addresses.myaddresses",{url:"/addresses/myaddresses",templateUrl:"home/addresses/myaddresses.view.0.7.1.html",controller:"AddressesController",controllerAs:"vm"}).state("home.home",{url:"/home",templateUrl:"home/home.view.0.7.1.html",controller:"AssetsController",controllerAs:"vm"}).state("home.explorer",{templateUrl:"home/explorer/index.view.0.7.1.html",controller:"ExplorerController"}).state("home.explorer.search",{url:"/explorer/search/:search",templateUrl:"home/explorer/search.view.0.7.1.html",controller:"ExplorerController"}).state("home.explorer.transaction",{url:"/explorer/tx/:hash",templateUrl:"home/explorer/transaction.view.0.7.1.html",controller:"ExplorerController"}).state("home.explorer.address",{url:"/explorer/adr/:address",templateUrl:"home/explorer/address.view.0.7.1.html",controller:"ExplorerController"}).state("home.explorer.block",{url:"/explorer/blk/:block",templateUrl:"home/explorer/block.view.0.7.1.html",controller:"ExplorerController"}).state("home.explorer.noresult",{url:"/explorer/noresult/:search",templateUrl:"home/explorer/noresult.view.0.7.1.html",controller:"ExplorerController"}).state("home.asset",{abstract:!0,templateUrl:"home/assets/index.view.0.7.1.html"}).state("home.asset.alldetails",{url:"/asset/all",templateUrl:"home/assets/all.view.0.7.1.html",controller:"ShowAllAssetsController",controllerAs:"vm"}).state("home.asset.myassets",{url:"/asset/myassets",templateUrl:"home/assets/myassets.view.0.7.1.html",controller:"ShowAssetsController",controllerAs:"vm"}).state("home.asset.details",{url:"/asset/details/:symbol",templateUrl:"home/assets/details.view.0.7.1.html",controller:"ShowAssetsController",controllerAs:"vm"}).state("home.asset.create",{url:"/asset/create",templateUrl:"home/assets/create.view.0.7.1.html",controller:"CreateAssetController",controllerAs:"vm"}).state("home.transferasset",{url:"/transfer/:symbol/:sender_address",templateUrl:"home/transfer/transferasset.view.0.7.1.html",controller:"TransferAssetController",controllerAs:"vm"}).state("home.transferetp",{url:"/transfer/ETP",templateUrl:"home/transfer/transferetp.view.0.7.1.html",controller:"ETPController",controllerAs:"vm"}).state("home.multisignature",{url:"/transfer/multisignature",templateUrl:"home/transfer/multisignature.view.0.7.1.html",controller:"ETPMultiSignController",controllerAs:"vm"}).state("home.sign",{url:"/transfer/sign",templateUrl:"home/transfer/sign.view.0.7.1.html",controller:"ETPMultiSignController",controllerAs:"vm"}).state("home.createmultisignature",{url:"/addresses/newmultisignature",templateUrl:"home/addresses/createmultisignature.view.0.7.1.html",controller:"ETPMultiSignController",controllerAs:"vm"}).state("home.deposit",{url:"/deposit/:symbol",templateUrl:"home/deposit.view.0.7.1.html",controller:"DepositController",controllerAs:"vm"}).state("home.console",{url:"/advanced",templateUrl:"home/console.view.0.7.1.html",controller:"ConsoleController"}),s.otherwise("/login")}function s(e,s,t,r){void 0!=t.get("language")&&r.use(t.get("language")),e.$on("$locationChangeStart",function(e,r,n){var o=-1===["/login","/register"].indexOf(s.path()),a=void 0!=t.get("credentials");o&&!a&&s.path("/login")})}angular.module("app",["ui.router","ngCookies","LocalStorageModule","pascalprecht.translate","angularUtils.directives.dirPagination","ngDialog","ngFileSaver"]).config(e).filter("assetformat",function(){return function(e,s){return void 0===s&&(s=8),parseFloat(e)/Math.pow(10,s)}}).config(["$compileProvider",function(e){}]).config(["localStorageServiceProvider",function(e){e.setPrefix("mvs.live")}]).config(["$translateProvider",function(e){e.useStaticFilesLoader({prefix:"lang/",suffix:".0.7.1.json"}),e.registerAvailableLanguageKeys(["en","de","zh"],{"en-US":"en","en-UK":"en","de-DE":"de","zh-ZH":"zh"}),e.useSanitizeValueStrategy("escapeParameters"),e.preferredLanguage("zh_ZH")}]).constant("appName","Metaverse").run(s),e.$inject=["$stateProvider","$urlRouterProvider"],s.$inject=["$rootScope","$location","localStorageService","$translate","FileSaver","Blob"]}(),function(){function e(e){var s={};return s.Success=function(s,t){e.flash={message:s,type:"success",keepAfterLocationChange:t}},s.Error=function(s,t){e.flash={message:s,type:"error",keepAfterLocationChange:t}},function(){function s(){var s=e.flash;s&&(s.keepAfterLocationChange?s.keepAfterLocationChange=!1:delete e.flash)}e.$on("$locationChangeStart",function(){s()})}(),s}angular.module("app").factory("FlashService",e),e.$inject=["$rootScope"]}(),function(){function e(e,s){function t(){s.selectedMenu={main:e.path().split("/")[1]}}t(),s.$on("$locationChangeStart",function(e,s,r){t()})}function s(e,s,t,r,n,o,a,c,l,i){function u(){void 0!==o.search&&d(1,2)}function d(s,t){for(var r=s;r<t&&!o.stopLoad;r++)NProgress.start(),e.ListTxsAddress(o.search,r).then(function(e){void 0!==e.success&&e.success&&void 0!=e.data?(e.data.total_page!=e.data.current_page||isNaN(e.data.total_page)||(o.stopLoad=!0),e.data.transactions.forEach(function(e){var s={height:e.height,hash:e.hash,timestamp:new Date(1e3*e.timestamp)};o.transactionsAddressSearch.push(s),o.exists=!0})):l("MESSAGES.NO_LISTED_TRANSACTIONS").then(function(e){a.Error(e),o.noResult=!0}),NProgress.done()})}function S(){var s=o.search;void 0!==s&&(NProgress.start(),e.FetchTx(s).then(function(e){if(void 0===e||void 0===e.success||0==e.success)l("MESSAGES.TRANSACTION_NOT_FOUND").then(function(e){a.Error(e)}),o.noResult=!0,i.scrollTo(0,0);else{o.transaction=e.data.transaction,o.exists=!0;var s=!0;o.transaction.inputs.forEach(function(e){e.display=!1,s?(e.first=!0,s=!1):e.first=!1}),o.transaction.outputs.forEach(function(e){e.display=!1,"etp"!=e.attachment.type&&h(e.attachment.symbol)}),o.transactionInputsValues=[],e.data.transaction.inputs.forEach(function(e){e.previous_output.hash})}NProgress.done()}))}function h(s){e.GetAsset(s).then(function(e){NProgress.done(),void 0!==e.success&&e.success?o.asset=e.data.assets[0]:(t.path("/asset/myassets"),l("MESSAGES.ASSETS_LOAD_ERROR").then(function(e){return a.Error(e)}))})}function p(){var s=o.search;o.blockInfos=[],void 0!==s&&(NProgress.start(),e.FetchHeader(s).then(function(e){void 0===e||void 0===e.success||0==e.success?(o.noResult=!0,l("MESSAGES.BLOCK_NOT_FOUND").then(function(e){a.Error(e)}),i.scrollTo(0,0)):(f(e.data.result.hash),o.exists=!0,o.blockInfos={hash:e.data.result.hash,timestamp:new Date(1e3*e.data.result.time_stamp),nonce:e.data.result.nonce,mixhash:e.data.result.mixhash,version:e.data.result.version,merkle_tree_hash:e.data.result.merkle_tree_hash,previous_block_hash:e.data.result.previous_block_hash}),NProgress.done()}))}function f(s){o.transactionsPerBlock=[],e.GetBlock(s).then(function(e){void 0===e||void 0===e.success||0==e.success?l("MESSAGES.TRANSACTION_NOT_FOUND").then(function(e){a.Error(e),t.path("/explorer")}):e.data.txs.transactions.forEach(function(e){o.transaction_count++;var s={hash:e.hash};o.transactionsPerBlock.push(s)}),NProgress.done()})}i.scrollTo(0,0),o.typeSearch=t.path().split("/")[2],o.search=t.path().split("/")[3],o.transactionsAddressSearch=[],o.searchAddressloadTransactions=d,o.searchAddressloadMore=function(){o.stopLoad||(o.page=o.page+1,d(o.page-1,o.page))},o.page=2,o.stopLoad=!1,o.showqr=function(e){angular.element(document).ready(function(){new QRCode(document.getElementById("qrcode"),{text:e,width:200,height:200,colorDark:"#000000",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.H})})},o.transaction_count=0,o.assets=[],o.exists=!1,o.noResult=!1,o.transactionInputsValues=[],o.asset="",""==o.typeSearch||"noresult"==o.typeSearch||"search"==o.typeSearch||("tx"===o.typeSearch?S():"adr"===o.typeSearch?u():"blk"===o.typeSearch?p():t.path("/explorer"))}function t(e,s,t,r,n,o,a,c,l,i){function u(){r.deposit_address="",r.value="",r.password="",r.value="",r.transactionFee=1e-4}function d(){s.GetBalance(function(e,s,t){e?(n.Error(t),c.scrollTo(0,0)):(r.balance=s,r.decimal_number=8,r.availableBalance=s["total-available"])})}c.scrollTo(0,0),r.symbol=i("uppercase")(l.path().split("/")[2]),r.deposit=function(){var s=o.get("credentials");if(""==r.password)a("MESSAGES.PASSWORD_NEEDED").then(function(e){return n.Error(e)}),c.scrollTo(0,0);else if(r.password!=s.password)a("MESSAGES.WRONG_PASSWORD").then(function(e){return n.Error(e)}),c.scrollTo(0,0);else if(r.value>0)if(r.transactionFee<1e-4)a("MESSAGES.TOO_LOW_FEE").then(function(e){return n.Error(e)}),c.scrollTo(0,0);else if(void 0==r.deposit_options[r.period_select])a("MESSAGES.INVALID_TIME_PERIOD").then(function(e){return n.Error(e)}),c.scrollTo(0,0);else{var t=(""+r.value*Math.pow(10,r.decimal_number)).split(".")[0],l=(""+r.transactionFee*Math.pow(10,r.decimal_number)).split(".")[0];("ETP"==r.symbol?e.Deposit(r.deposit_options[r.period_select][2],t,l,r.password,r.address_option?r.deposit_address:void 0):e.FrozenAsset(r.deposit_options[r.period_select][2],t,l,r.password,r.symbol,r.address_option?r.deposit_address:void 0)).then(function(e){NProgress.done(),void 0!==e.success&&e.success&&void 0==e.data.error?(u(),a("MESSAGES.DEPOSIT_SUCCESS").then(function(s){return n.Success(s+e.data.transaction.hash)}),c.scrollTo(0,0),u()):(a("MESSAGES.DEPOSIT_ERROR").then(function(e){return n.Error(e)}),c.scrollTo(0,0),r.password="")})}else a("MESSAGES.INVALID_VALUE").then(function(e){return n.Error(e)}),c.scrollTo(0,0)},r.period_select=void 0,r.assetsIssued=[],r.balance=[],r.transactionFee=1e-4,r.availableBalance=0,r.sendAll=function(){r.value=(r.availableBalance-1e8*r.transactionFee)/1e8},r.isNumber=angular.isNumber,e.ListAssets().then(function(e){void 0!==e.success&&e.success?""!=e.data.assets&&e.data.assets.forEach(function(e){"unspent"==e.status&&(r.assetsIssued.push({symbol:e.symbol}),e.symbol==r.symbol&&(r.balance["total-unspent"]=e.quantity,r.balance["total-frozen"]=e.quantity,r.decimal_number=e.decimal_number))}):(a("MESSAGES.ASSETS_LOAD_ERROR").then(function(e){return n.Error(e)}),c.scrollTo(0,0)),"ETP"==r.symbol&&d()}),r.deposit_options={"DEPOSIT.PERIOD.WEEK":[9589e-7,.05,7],"DEPOSIT.PERIOD.MONTH":[.0066667,.08,30],"DEPOSIT.PERIOD.QUARTER":[.032,.128,90],"DEPOSIT.PERIOD.HALF_YEAR":[.08,.16,182],"DEPOSIT.PERIOD.YEAR":[.2,.2,365]},r.setDepositPeriod=function(e){r.period_select=e},u()}function r(e,s,t,r,n,o,a,c){function l(){i(),r.sendfrom="",r.sendto="",r.fee="",r.message="",r.value="",r.password="",r.transactionFee=1e-4,r.memo="",e.ListBalances(!0).then(function(e){e.success&&(r.from_addresses=e.data.balances)}),r.recipents=[],r.recipents.push({index:1,address:"",value:""})}function i(){s.GetBalance(function(e,s,t){e?(n.Error(t),c.scrollTo(0,0)):(r.balance=s,r.availableBalance=s["total-available"])})}function u(){NProgress.start();var s="",t="",o=1e8*r.transactionFee;r.recipents.forEach(function(e){s=e.value,t=e.address}),s*=1e8,s=Math.round(s),(r.sendfrom?e.SendFrom(r.sendfrom,t,s,o,r.memo):e.Send(t,s,o,r.memo)).then(function(e){NProgress.done(),void 0!==e.success&&e.success?(a("MESSAGES.TRANSFER_SUCCESS").then(function(s){return n.Success(s+e.data.transaction.hash)}),c.scrollTo(0,0),l()):(a("MESSAGES.TRANSFER_ERROR").then(function(s){void 0!=e.message?n.Error(s+" "+e.message):n.Error(s)}),c.scrollTo(0,0),r.password="")})}function d(){NProgress.start();var s=[],t=1e8*r.transactionFee;r.recipents.forEach(function(e){var t=e.value;t*=1e8,t=Math.round(t),s.push({address:e.address,value:t})}),e.SendMore(s,t).then(function(e){NProgress.done(),void 0!==e.success&&e.success?(a("MESSAGES.TRANSFER_SUCCESS").then(function(s){return n.Success(s+e.data.transaction.hash)}),c.scrollTo(0,0),l()):(a("MESSAGES.TRANSFER_ERROR").then(function(s){void 0!=e.message?n.Error(s+" "+e.message):n.Error(s)}),c.scrollTo(0,0),r.password="")})}c.scrollTo(0,0),NProgress.start(),r.transfer=function(){var e=!0;r.recipents.forEach(function(s){""===s.address?(a("MESSAGES.TRANSACTION_RECIPENT_ADDRESS_NEEDED").then(function(e){return n.Error(e)}),c.scrollTo(0,0),e=!1):34!=s.address.length?(a("MESSAGES.TRANSACTION_RECIPENT_WRONG").then(function(e){return n.Error(e+" "+s.index)}),c.scrollTo(0,0),e=!1):void 0===s.value||""===s.value?(a("MESSAGES.TRANSACTION_VALUE_NEEDED").then(function(e){return n.Error(e)}),c.scrollTo(0,0),e=!1):s.value>r.availableBalance/1e8-r.transactionFee&&(a("MESSAGES.TRANSACTION_AMOUNT_NOT_ENOUGH").then(function(e){return n.Error(e)}),c.scrollTo(0,0),e=!1)}),!1===e||(""===r.password?(a("MESSAGES.PASSWORD_NEEDED").then(function(e){return n.Error(e)}),c.scrollTo(0,0)):r.transactionFee<1e-4?(a("MESSAGES.TOO_LOW_FEE").then(function(e){return n.Error(e)}),c.scrollTo(0,0)):o.get("credentials").password!=r.password?(a("MESSAGES.WRONG_PASSWORD").then(function(e){return n.Error(e)}),c.scrollTo(0,0)):1==r.recipents.length?u():d()),c.scrollTo(0,0)},r.typeTransaction="simple",r.underlineAuto="underline",r.underlineManual="none",r.autoSelectAddress=!0,r.selectAddressAvailable=!0,r.transactionFee=1e-4,r.memo="",r.getBalance=i,r.recipents=[],r.listAddresses=[],r.symbol="ETP",r.availBalance=function(e){r.availableBalance=""==e?r.balance["total-available"]:r.addresses[e].balance-r.addresses[e].frozen},r.availableBalance=0,r.sendAll=function(){r.recipents[0].value=(r.availableBalance-1e8*r.transactionFee)/1e8},i(),r.addRecipent=function(){r.recipents.push({index:r.recipents.length+1,address:"",value:""}),r.autoSelectAddress=!0,r.underlineAuto="underline",r.underlineManual="none",r.sendfrom="",r.selectAddressAvailable=!1},r.removeRecipent=function(){r.recipents.splice(r.recipents.length-1,1),1==r.recipents.length&&(r.selectAddressAvailable=!0)},NProgress.start(),e.ListBalances().then(function(s){void 0!==s.success&&s.success&&(r.addresses=[],s.data.balances.forEach(function(e){var s="New address";void 0!=o.get(e.balance.address)&&(s=o.get(e.balance.address)),r.addresses[e.balance.address]={balance:parseInt(e.balance.unspent),address:e.balance.address,name:s,frozen:e.balance.frozen,type:"single"},r.listAddresses.push({balance:parseInt(e.balance.unspent),available:parseInt(e.balance.available),address:e.balance.address})}),e.ListMultiSig().then(function(e){void 0!==e.success&&e.success&&""!=e.data.multisig&&e.data.multisig.forEach(function(e){r.addresses[e.address].type="multisig"})}))}),NProgress.done(),l(),NProgress.done()}function n(e,s,t,r,n,o,a,c){function l(){r.sendfrom="",r.sendto="",r.fee="",r.message="",r.value="",r.password="",r.availableBalance=0,r.publicKey="",e.ListBalances(!0).then(function(e){e.success&&(r.from_addresses=e.data.balances)}),r.recipents=[],r.recipents.push({index:1,address:"",value:""}),r.cosigners=[],r.cosigners.push({index:1,publicKey:""}),r.nbrCosignersRequired=0,r.selectedMutliSigAddress=[],r.transferSuccess=!1,r.resultCreateTx=""}c.scrollTo(0,0),NProgress.start(),r.underlineAuto="underline",r.underlineManual="none",r.autoSelectAddress=!1,r.displayEmptyAdresses=!1,r.recipents=[],r.getPublicKey=function(s){NProgress.start(),e.GetPublicKey(s).then(function(e){void 0!==e.success&&e.success?r.publicKey=e.data["public-key"]:(a("MESSAGES.ADDRESS_NOT_FOUND").then(function(e){return n.Error(e)}),c.scrollTo(0,0))}),NProgress.done()},r.publicKey="",r.cosigners=[],r.getNewMultisign=function(){NProgress.start();var s=!0;r.cosigners.forEach(function(e){66!=e.publicKey.length&&(a("MESSAGES.CREATE_MULTISIGNATURE_WRONG_PUBLIC_KEY").then(function(s){return n.Error(s+" "+e.index)}),c.scrollTo(0,0),s=!1)}),0==s||(""===r.password?(a("MESSAGES.PASSWORD_NEEDED").then(function(e){return n.Error(e)}),c.scrollTo(0,0)):e.GetNewMultiSig(r.nbrCosignersRequired,r.cosigners.length+1,r.publicKey,r.cosigners).then(function(e){NProgress.done(),void 0!==e.success&&e.success?(a("MESSAGES.CREATE_MULTISIGNATURE_SUCCESS").then(function(s){return n.Success(s+" "+e.data.address)}),c.scrollTo(0,0),l()):(a("MESSAGES.CREATE_MULTISIGNATURE_ERROR").then(function(s){void 0!=e.message?(n.Error(s+" "+e.message),c.scrollTo(0,0)):(n.Error(s),c.scrollTo(0,0))}),r.password="")})),NProgress.done()},r.nbrCosignersRequired=0,r.availableBalance=0,r.sendAllMultisig=function(){r.quantity=(r.availableBalance-1e8*r.transactionFee)/1e8},r.transactionFee=1e-4,r.listAddresses=[],r.listMultiSig=[],r.selectedMutliSigAddress=[],r.setMultiSigAddress=function(e){r.selectedMutliSigAddress=e},r.createMultisigTx=function(s,t,o,i){var u=(""+o*Math.pow(10,8)).split(".")[0],d=(""+i*Math.pow(10,8)).split(".")[0];""===r.password?(a("MESSAGES.PASSWORD_NEEDED").then(function(e){return n.Error(e)}),c.scrollTo(0,0)):u>r.availableBalance-d?(a("MESSAGES.TRANSACTION_AMOUNT_NOT_ENOUGH").then(function(e){return n.Error(e)}),c.scrollTo(0,0)):e.CreateMultisigTx(s,t,u,d).then(function(e){NProgress.done(),void 0!==e.success&&e.success?(a("MESSAGES.CREATE_MULTISIGNATURE_SUCCESS").then(function(e){return n.Success(e)}),c.scrollTo(0,0),l(),r.transferSuccess=!0,r.resultCreateTx=e.data):(a("MESSAGES.CREATE_MULTISIGNATURE_ERROR").then(function(s){void 0!=e.message?(n.Error(s+" "+e.message),c.scrollTo(0,0)):(n.Error(s),c.scrollTo(0,0))}),r.password="")})},r.transferSuccess=!1,r.resultCreateTx="",r.signMultisigTx=function(s,t){e.SignMultisigTx(s,t).then(function(e){NProgress.done(),void 0!==e.success&&e.success?(t?(a("MESSAGES.SIGN_AND_BROADCAST_SUCCESS").then(function(e){return n.Success(e)}),c.scrollTo(0,0)):(a("MESSAGES.SIGN_SUCCESS").then(function(e){return n.Success(e)}),c.scrollTo(0,0)),l(),r.transferSuccess=!0,r.resultSignTx=e.data):(a("MESSAGES.SIGN_ERROR").then(function(s){void 0!=e.message?n.Error(s+" "+e.message):n.Error(s)}),c.scrollTo(0,0),r.password="")})},r.addCoSigner=function(){r.cosigners.push({index:r.cosigners.length+1,publicKey:""})},r.removeCoSigner=function(){r.cosigners.splice(r.cosigners.length-1,1)},r.getNumber=function(e){return new Array(e)},s.GetBalance(function(e,s,t){e?(n.Error(t),c.scrollTo(0,0)):r.balance=s}),NProgress.start(),e.ListBalances().then(function(s){void 0!==s.success&&s.success&&(r.addresses=[],s.data.balances.forEach(function(e){var s="New address";void 0!=o.get(e.balance.address)&&(s=o.get(e.balance.address)),r.addresses[e.balance.address]={balance:parseInt(e.balance.unspent),address:e.balance.address,name:s,frozen:e.balance.frozen,type:"single"},r.listAddresses.push({balance:parseInt(e.balance.unspent),available:parseInt(e.balance.available),address:e.balance.address})}),e.ListMultiSig().then(function(e){void 0!==e.success&&e.success&&""!=e.data.multisig&&e.data.multisig.forEach(function(e){r.addresses[e.address].type="multisig";var s="New address";void 0!=o.get(e.address)&&(s=o.get(e.address)),r.listMultiSig.push({index:e.index,m:e.m,n:e.n,selfpublickey:e["self-publickey"],description:e.description,address:e.address,name:s,balance:r.addresses[e.address].balance,publicKeys:e["public-keys"]})})}))}),NProgress.done(),l()}function o(e,s,t,r,n,o,a,c,l){function i(){NProgress.start(),s.ListBalances().then(function(e){void 0!==e.success&&e.success&&(n.addresses=[],e.data.balances.forEach(function(e){var s=c.get(e.balance.address);void 0==s&&(s="New Address"),n.addresses.push({balance:parseInt(e.balance.unspent),address:e.balance.address,frozen:e.balance.frozen,name:s,edit:!1})}),n.addressesDisplay=n.addresses,n.addressesFiltered=[],n.addresses.forEach(function(e){0!=e.balance&&n.addressesFiltered.push(e)})),NProgress.done()})}l.scrollTo(0,0),n.addresses=[],n.addressesFiltered=[],n.addressesDisplay=[],n.displayEmpty=function(){n.addressesDisplay=n.addresses},n.hideEmpty=function(){n.addressesDisplay=n.addressesFiltered},n.getnewaddress=function(){s.GetNewAddress().then(function(e){void 0!==e.success&&e.success&&(t("MESSAGES.CREATED_ADDRESS").then(function(e){return o.Success(e)}),l.scrollTo(0,0),i())})},n.showqr=function(e){$("#showqrmodal").modal(),$("#modal_address").html(e),$("#modal_qr").html("");new QRCode(document.getElementById("modal_qr"),{text:e,width:300,height:300,colorDark:"#000000",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.H});$("#showqrmodal").modal("show")},n.buttonCopyToClipboard=new Clipboard(".btn"),n.enableEditAddressName=function(e){n.addresses.forEach(function(s){s.address==e&&(s.newName=s.name,s.edit=!0)})},n.endEditAddressName=function(e,s){c.set(e,s),n.addresses.forEach(function(t){t.address==e&&(t.name=s,t.edit=!1)})},n.cancelEditAddressName=function(e){n.addresses.forEach(function(s){s.address==e&&(s.newName=s.name,s.edit=!1)})},n.newName="New Address",n.balance={},"multisignatureaddresses"==a.path().split("/")[2]||"myaddresses"==a.path().split("/")[2]&&i(),e.GetBalance(function(e,s,t){e?(o.Error(t),l.scrollTo(0,0)):n.balance=s})}function a(e,s,t,r,n,o,a,c,l,i){c.scrollTo(0,0),r.showprivatekey=function(t,o){void 0==t?(s("MESSAGES.PASSWORD_NEEDED_FOR_PRIVATE_KEY").then(function(e){return n.Error(e)}),c.scrollTo(0,0)):a.get("credentials").password!=t?(s("MESSAGES.WRONG_PASSWORD").then(function(e){return n.Error(e)}),c.scrollTo(0,0)):(NProgress.start(),e.GetAccount(o).then(function(e){void 0!==e.success&&e.success?r.privatekey=e.data["mnemonic-key"]:(s("SETTINGS.MNEMONIC_LOAD_ERROR").then(function(e){return n.Error(e)}),c.scrollTo(0,0)),NProgress.done()}))},r.changepassword=function(t,r,l){void 0==t||a.get("credentials").password!=t?(s("MESSAGES.WRONG_PASSWORD").then(function(e){return n.Error(e)}),c.scrollTo(0,0)):void 0==r||r.length<6?(s("MESSAGES.PASSWORD_SHORT").then(function(e){return n.Error(e)}),c.scrollTo(0,0)):r!=l?(s("MESSAGES.PASSWORD_NOT_MATCH").then(function(e){return n.Error(e)}),c.scrollTo(0,0)):(NProgress.start(),e.ChangePassword(r).then(function(e){void 0!==e.success&&e.success?s("MESSAGES.CHANGE_PASSWORD_SUCCESS").then(function(e){n.Success(e,!0),o.path("/login")}):(s("SETTINGS.CHANGE_PASSWORD_ERROR").then(function(e){return n.Error(e)}),c.scrollTo(0,0)),NProgress.done()}))},r.exportAccount=function(t,r,o){a.get("credentials").password!=t?(s("MESSAGES.WRONG_PASSWORD").then(function(e){return n.Error(e)}),c.scrollTo(0,0)):o.split(" ").length>1?(s("MESSAGES.CONTAINS_SPACE").then(function(e){return n.Error(e)}),c.scrollTo(0,0)):(NProgress.start(),e.ExportAccountAsFile(t,r,o).then(function(e){void 0!==e.success&&e.success?(s("MESSAGES.EXPORT_ACCOUNT_FILE_SUCCESS").then(function(e){n.Success(e)}),c.scrollTo(0,0)):(s("MESSAGES.EXPORT_ACCOUNT_FILE_ERROR").then(function(s){void 0!=e.message?n.Error(s+" "+e.message):n.Error(s)}),c.scrollTo(0,0)),NProgress.done()}))},r.accountname=a.get("credentials").user,r.debugState=e.debug,r.path="",r.setDeugger=function(s){e.debug=1==s,r.debugState=e.debug}}function c(e,s,t,r,n,o,a,c,l,i){function u(){NProgress.start(),e.ListBalances().then(function(e){void 0!==e.success&&e.success?(r.allAddresses=[],e.data.balances.forEach(function(e){r.allAddresses.push({address:e.balance.address})}),d()):(n("MESSAGES.ASSETS_LOAD_ERROR").then(function(e){return c.Error(e)}),l.scrollTo(0,0)),NProgress.done()})}function d(){NProgress.start(),r.assetAddresses=[],r.allAddresses.forEach(function(s){e.GetAddressAsset(s.address).then(function(e){void 0!==e.success&&e.success&&""!=e.data.assets&&e.data.assets.forEach(function(e){if(e.symbol==r.symbol){var s="New address";void 0!=a.get(e.address)&&(s=a.get(e.address)),e.name=s,r.assetAddresses.push(e)}})})}),NProgress.done()}l.scrollTo(0,0),r.symbol=i("uppercase")(o.path().split("/")[2]),r.sender_address=s.sender_address,r.sendasset=function(s,t,i){a.get("credentials").password!=r.password?(n("MESSAGES.WRONG_PASSWORD").then(function(e){return c.Error(e)}),l.scrollTo(0,0)):void 0==r.recipent_address?(n("MESSAGES.TRANSACTION_RECIPENT_ADDRESS_NEEDED").then(function(e){return c.Error(e)}),l.scrollTo(0,0)):34!=r.recipent_address.length?(n("MESSAGES.TRANSACTION_RECIPENT_WRONG").then(function(e){return c.Error(e)}),l.scrollTo(0,0)):void 0!=r.quantity&&r.quantity>0?"3"==r.recipent_address.charAt(0)?(n("MESSAGES.TRANSACTION_ASSET_MULTISIG").then(function(e){return c.Error(e)}),l.scrollTo(0,0)):(i*=Math.pow(10,r.asset.decimal_number),(r.sendfrom?e.SendAssetFrom(r.sendfrom,s,t,i):e.SendAsset(s,t,i)).then(function(e){NProgress.done(),void 0!==e.success&&e.success?n("MESSAGES.ASSETS_TRANSFER_SUCCESS").then(function(s){c.Success(s+e.data.transaction.hash,!0),o.path("/asset/myassets")}):(n("MESSAGES.ASSETS_TRANSFER_ERROR").then(function(s){return c.Error(s+" "+e.message)}),l.scrollTo(0,0))})):(n("MESSAGES.TRANSACTION_VALUE_NEEDED").then(function(e){return c.Error(e)}),l.scrollTo(0,0))},r.underlineAuto="underline",r.underlineManual="none",r.autoSelectAddress=!0,r.assetsIssued=[],r.allAddresses=[],r.assetAddresses=[],r.listBalances=u,r.listAssetBalances=d,r.availBalance=function(e){""==e?r.availableBalance=r.asset.quantity:r.assetAddresses.forEach(function(s){s.address==e&&(r.availableBalance=s.quantity)})},r.availableBalance=0,r.sendAll=function(){r.quantity=parseFloat(r.availableBalance)/Math.pow(10,r.asset.decimal_number)},e.ListAssets().then(function(e){void 0!==e.success&&e.success?""!=e.data.assets&&e.data.assets.forEach(function(e){"unspent"==e.status&&r.assetsIssued.push({symbol:e.symbol,quantity:e.quantity,decimal_number:e.decimal_number})}):(n("MESSAGES.ASSETS_LOAD_ERROR").then(function(e){return c.Error(e)}),l.scrollTo(0,0))}),u(),r.sendfrom="",r.sendto="",r.fee="",r.message="",r.value="",r.password="",function(s){e.GetAsset(s).then(function(e){NProgress.done(),void 0!==e.success&&e.success?(r.asset=e.data.assets[0],r.assetsIssued.forEach(function(e){e.symbol==s&&(r.asset.quantity=e.quantity,r.availableBalance=e.quantity)})):(o.path("/asset/myassets"),n("MESSAGES.ASSETS_LOAD_ERROR").then(function(e){return c.Error(e)}))})}(r.symbol)}function l(e,s,t,r,n,o,a,c){c.scrollTo(0,0),t.symbol=a.symbol,t.assets=[],NProgress.start(),e.ListAllAssets().then(function(e){NProgress.done(),void 0!==e.success&&e.success?(t.assets=[],t.assets=e.data.assets,t.assets.forEach(function(e){void 0!=e&&(e.details=!1)})):o("MESSAGES.ASSETS_LOAD_ERROR").then(function(e){n.Error(e),r.path("/asset/myassets")})})}function i(e,s,t,r,n,o,a,c,l,i){function u(s){e.GetAsset(s).then(function(e){void 0!==e.success&&e.success?(t.asset=e.data.assets[0],t.asset.issuer==r.get("credentials").user&&(t.owner=!0),t.initial_maximum_supply=parseFloat(t.asset.maximum_supply)/Math.pow(10,t.asset.decimal_number),t.current_maximum_supply=t.initial_maximum_supply,t.new_maximum_supply=t.initial_maximum_supply,t.details=!1,t.assets.forEach(function(e){e.symbol==s&&(t.asset.quantity=e.quantity)})):(o("MESSAGES.ASSETS_LOAD_ERROR").then(function(e){return n.Error(e)}),l.scrollTo(0,0)),NProgress.done()})}function d(){NProgress.start(),e.ListBalances().then(function(e){void 0!==e.success&&e.success?(t.allAddresses=[],e.data.balances.forEach(function(e){t.allAddresses.push({address:e.balance.address})}),S()):(o("MESSAGES.ASSETS_LOAD_ERROR").then(function(e){return n.Error(e)}),l.scrollTo(0,0)),NProgress.done()})}function S(){NProgress.start(),t.assetAddresses=[],t.allAddresses.forEach(function(s){e.GetAddressAsset(s.address).then(function(e){void 0!==e.success&&e.success&&""!=e.data.assets&&e.data.assets.forEach(function(e){if(e.symbol==t.symbol){var s="New address";void 0!=r.get(e.address)&&(s=r.get(e.address)),e.name=s,e.edit=!1,t.assetAddresses.push(e)}})})}),NProgress.done()}l.scrollTo(0,0),t.symbol=a.symbol,t.assets=[],t.issue=function(s){NProgress.start(),e.Issue(s).then(function(e){void 0!==e.success&&e.success?(u(t.symbol),o("MESSAGES.ASSETS_ISSUE_SUCCESS").then(function(e){return n.Success(e)}),l.scrollTo(0,0)):(o("MESSAGES.ASSETS_ISSUE_ERROR").then(function(e){return n.Error(e)}),l.scrollTo(0,0)),NProgress.done()})},t.secondIssue=function(s,r,a){NProgress.start(),(r*=Math.pow(10,a))<0&&(o("MESSAGES.ASSETS_SECOND_ISSUE_ERROR").then(function(e){return n.Error(e)}),l.scrollTo(0,0)),e.SecondIssue(s,r).then(function(e){void 0!==e.success&&e.success?(u(t.symbol),o("MESSAGES.ASSETS_SECOND_ISSUE_SUCCESS").then(function(e){return n.Success(e)}),l.scrollTo(0,0)):(o("MESSAGES.ASSETS_SECOND_ISSUE_ERROR").then(function(s){return n.Error(s+" "+e.message)}),l.scrollTo(0,0)),NProgress.done()})},t.deleteAsset=function(s){e.Delete(s).then(function(e){NProgress.done(),void 0!==e.success&&e.success?(o("MESSAGES.ASSETS_DELETE_SUCCESS").then(function(e){return n.Success(e,!0)}),l.scrollTo(0,0),c.path("/asset/myassets")):(o("MESSAGES.ASSETS_DELETE_ERROR").then(function(e){return n.Error(e)}),l.scrollTo(0,0))})},t.editMaxSupply=!1,t.enableEditAssetMaxSupply=function(){t.editMaxSupply=!0},t.endEditAssetMaxSupply=function(){t.editMaxSupply=!1},t.cancelEditAssetMaxSupply=function(){t.increase_maximum_supply=0,t.editMaxSupply=!1},t.increase_maximum_supply=0,t.owner=!1,t.listBalances=d,t.listAssetBalances=S,t.enableEditAddressName=function(e){t.assetAddresses.forEach(function(s){s.address==e&&(s.newName=s.name,s.edit=!0)})},t.endEditAddressName=function(e,s){r.set(e,s),t.assetAddresses.forEach(function(t){t.address==e&&(t.name=s,t.edit=!1)})},t.cancelEditAddressName=function(e){t.assetAddresses.forEach(function(s){s.address==e&&(s.newName=s.name,s.edit=!1)})},t.showqr=function(e){$("#showqrmodal").modal(),$("#modal_address").html(e),$("#modal_qr").html("");new QRCode(document.getElementById("modal_qr"),{text:e,width:300,height:300,colorDark:"#000000",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.H});$("#showqrmodal").modal("show")},t.buttonCopyToClipboard=new Clipboard(".btn"),NProgress.start(),e.ListAssets().then(function(e){NProgress.done(),""!=e.data.assets?void 0!==e.success&&e.success?(t.assets=[],t.assets=e.data.assets,void 0!=t.symbol&&""!=t.symbol&&(NProgress.start(),u(t.symbol))):(c.path("/asset/myassets"),o("MESSAGES.ASSETS_LOAD_ERROR").then(function(e){return n.Error(e)})):void 0!=t.symbol&&""!=t.symbol&&(NProgress.start(),u(t.symbol))}),d(),t.closeAll=function(){i.closeAll()}}function u(e,s,t,r,n,o,a,c,l){function i(){for(var e in t.error)if(t.error[e])return void(t.submittable=!1);t.submittable=!0}function u(e){t.symbol=e,l.open({template:"templateId",scope:t})}c.scrollTo(0,0),t.error={},t.createasset=function(){n.get("credentials").password!=t.password?(a("MESSAGES.WRONG_PASSWORD").then(function(e){return r.Error(e)}),c.scrollTo(0,0)):(NProgress.start(),e.CreateAsset(t.symbol,t.max_supply,t.secondary_offering,t.decimals,t.description).then(function(e){NProgress.done(),void 0!==e.success&&e.success?(u(t.symbol),a("MESSAGES.ASSSET_CREATED_LOCAL_SUCCESS").then(function(e){r.Success(e,!0)}),c.scrollTo(0,0)):(a("MESSAGES.ASSETS_CREATE_ERROR").then(function(s){return r.Error(s+" "+e.message)}),c.scrollTo(0,0))}))},t.popupIssue=u,t.issue=function(s){NProgress.start(),e.Issue(s).then(function(e){void 0!==e.success&&e.success?(a("MESSAGES.ASSETS_ISSUE_SUCCESS").then(function(e){return r.Success(e)}),c.scrollTo(0,0)):(a("MESSAGES.ASSETS_ISSUE_ERROR").then(function(e){return r.Error(e)}),c.scrollTo(0,0)),NProgress.done()})},t.symbol="",t.description="",t.max_supply=0,t.secondary_offering=0,t.decimals="",t.password="",t.$watch("max_supply",function(e,s){t.error.max_supply=void 0==e||!(e==parseInt(e)),i()}),t.$watch("symbol",function(e,s){t.error.symbol=void 0==e||!e.match(/^[0-9A-Za-z.]+$/),i()}),t.$watch("decimals",function(e,s){t.error.decimals=void 0==e||!(e>=0&&e<=8),i()}),t.$watch("description",function(e,s){t.error.description=void 0==e||!(e.length>0),i()}),t.$watch("password",function(e,s){t.error.password=!(void 0!=e&&e.length>=6&&n.get("credentials").password==t.password),i()}),t.range=function(e,s,t){t=t||1;for(var r=[],n=e;n<=s;n+=t)r.push(n);return r},t.closeAll=function(){l.closeAll()}}function d(e,s,t,r,n,o,a,c){function l(){r.transactionsFiltered=[],"ALL"==r.assetType?r.transactionsFiltered=r.transactions:r.transactions.forEach(function(e){e.type==r.assetType&&r.transactionsFiltered.push(e)})}function i(s,t){for(var n=s;n<t&&!r.stopLoad;n++)e.LoadTransactions(function(e,s){e?(o("MESSAGES.TRANSACTIONS_LOAD_ERROR").then(function(e){return a.Error(e)}),c.scrollTo(0,0)):(1!=s.lastpage&&void 0!=s.lastpage||(r.stopLoad=!0),s.forEach(function(e){1==e.frozen&&e.recipents.forEach(function(s){for(var t=/\[ (\w+) ] numequalverify dup hash160 \[ (\w+) \] equalverify checksig/,r=s.script.replace(t,"$1"),n=r.length,o="",a=0;a<n;a+=2)o+=r.charAt(n-a-2),o+=r.charAt(n-a-1);var c=parseInt(o,16);e.availableBlockNo=parseInt(e.height)+parseInt(c)}),r.transactions.push(e)}),l()),NProgress.done()},"asset",n)}c.scrollTo(0,0),r.assets=[],r.balance={},r.transactions=[],r.transactionsFiltered=[],r.showDates=!1,r.startDate=new Date(new Date-6048e5),r.endDate=new Date,r.startDateUpdated=new Date,r.endDateUpdated=new Date,r.assetType="ALL",r.filterOnAsset=function(e){r.assetType=e,l()},r.loadTransactions=i,r.loadMore=function(){r.stopLoad||(r.page=r.page+1,i(r.page-1,r.page))},r.stopLoad=!1,r.page=3,e.GetBalance(function(e,s,t){e?a.Error(t):r.balance=s}),s.ListAssets().then(function(e){""!=e.data.assets?void 0!==e.success&&e.success?r.assets=e.data.assets:(o("MESSAGES.ASSETS_LOAD_ERROR").then(function(e){return a.Error(e)}),c.scrollTo(0,0)):r.assets=""}),i(1,3)}function S(e,s,t,r,n,o){function a(){window.setTimeout(function(){var e=document.getElementById("consolelog");e.scrollTop=e.scrollHeight},100)}function c(){NProgress.start(),e.GetMiningInfo().then(function(e){NProgress.done(),void 0!==e.success&&e.success?(n.status=e.data["mining-info"],n.isMining="true"===e.data["mining-info"].status):(r("MESSAGES.MINING_STATUS_ERROR").then(function(e){return t.Error(e)}),o.scrollTo(0,0))})}o.scrollTo(0,0);var l=new WebSocket("ws://localhost:8820/ws");$("#inputField").focus(),n.showConnected=!1,n.index=0,l.onmessage=function(e){n.showConnected=!0,n.index++,NProgress.done(),n.consolelog.push({query:n.querystring,answer:e.data,index:n.index}),n.querystring="",n.$apply(),a()},n.querystring="",n.consolelog=[],n.query=function(){NProgress.start(),l.send(n.querystring)},n.start=function(){NProgress.start(),e.Start().then(function(e){NProgress.done(),void 0!==e.success&&e.success?(r("MESSAGES.MINING_START_SUCCESS").then(function(e){return t.Success(e)}),o.scrollTo(0,0),c()):(r("MESSAGES.MINING_START_ERROR").then(function(e){return t.Error(e)}),o.scrollTo(0,0))})},n.stop=function(){NProgress.start(),e.Stop().then(function(e){NProgress.done(),void 0!==e.success&&e.success?(r("MESSAGES.MINING_STOP_SUCCESS").then(function(e){return t.Success(e)}),o.scrollTo(0,0),c()):(r("MESSAGES.MINING_STOP_ERROR").then(function(e){return t.Error(e)}),o.scrollTo(0,0))})},n.status={},n.isMining=!1,c()}function h(e,s,t,r,n,o,a,c){function l(){e.FetchHeight().then(function(e){void 0!==e.success&&e.success&&(t.height=e.data,s.height=e.data)})}function i(e){""===e||void 0==e?a.path("/explorer/search/"):"ETP"===c("uppercase")(e)?a.path("/addresses/myaddresses"):64===e.length?a.path("/explorer/tx/"+e):34===e.length?a.path("/explorer/adr/"+e):isNaN(e)?u(e):a.path("/explorer/blk/"+e)}function u(s){var t="/explorer/noresult/"+s;NProgress.start(),e.ListAllAssets().then(function(e){NProgress.done(),void 0!==e.success&&e.success?e.data.assets.forEach(function(e){c("uppercase")(s)==e.symbol&&(t="/asset/details/"+s)}):(o("MESSAGES.ASSETS_LOAD_ERROR").then(function(e){FlashService.Error(e)}),$window.scrollTo(0,0)),a.path(t)}),NProgress.done()}var d=this;d.account=r.get("credentials").user,t.height="",t.assets=[],t.language=r.get("language"),t.menu={account:{show:0},assets:{show:0}},d.changeLang=function(e){return o.use(e).then(function(e){return r.set("language",e)}).catch(function(e){return console.log("Cannot change language.")})},l(),n(function(){return l()},1e4),t.show_account_menu=function(){t.menu.account.show=1-t.menu.account.show,t.menu.assets.show=0},t.show_assets_menu=function(){t.menu.assets.show=1-t.menu.assets.show,t.menu.account.show=0},d.search=function(e){return i(e)}}h.$inject=["MetaverseService","$rootScope","$scope","localStorageService","$interval","$translate","$location","$filter"],e.$inject=["$location","$rootScope"],S.$inject=["MetaverseService","$rootScope","FlashService","$translate","$scope","$window"],o.$inject=["MetaverseHelperService","MetaverseService","$translate","$rootScope","$scope","FlashService","$location","localStorageService","$window"],a.$inject=["MetaverseService","$translate","$rootScope","$scope","FlashService","$location","localStorageService","$window","FileSaver","Blob"],c.$inject=["MetaverseService","$stateParams","$rootScope","$scope","$translate","$location","localStorageService","FlashService","$window","$filter"],u.$inject=["MetaverseService","$rootScope","$scope","FlashService","localStorageService","$location","$translate","$window","ngDialog"],d.$inject=["MetaverseHelperService","MetaverseService","$rootScope","$scope","$location","$translate","FlashService","$window"],i.$inject=["MetaverseService","$rootScope","$scope","localStorageService","FlashService","$translate","$stateParams","$location","$window","ngDialog"],l.$inject=["MetaverseService","$rootScope","$scope","$location","FlashService","$translate","$stateParams","$window"],r.$inject=["MetaverseService","MetaverseHelperService","$rootScope","$scope","FlashService","localStorageService","$translate","$window"],n.$inject=["MetaverseService","MetaverseHelperService","$rootScope","$scope","FlashService","localStorageService","$translate","$window"],t.$inject=["MetaverseService","MetaverseHelperService","$rootScope","$scope","FlashService","localStorageService","$translate","$window","$location","$filter"],s.$inject=["MetaverseService","MetaverseHelperService","$location","$stateParams","$rootScope","$scope","FlashService","localStorageService","$translate","$window"],angular.module("app").controller("HomeController",h).controller("MenuController",e).controller("ConsoleController",S).controller("AddressesController",o).controller("AccountController",a).controller("TransferAssetController",c).controller("CreateAssetController",u).controller("AssetsController",d).controller("ShowAssetsController",i).controller("ShowAllAssetsController",l).controller("ETPController",r).controller("ETPMultiSignController",n).controller("DepositController",t).controller("ExplorerController",s).directive("bsTooltip",function(){return{restrict:"A",link:function(e,s,t){$(s).hover(function(){$(s).tooltip("show")},function(){$(s).tooltip("hide")})}}}).directive("bsPopover",["$compile","$timeout",function(e,s){return function(e,s){$(s).popover(),$("body").on("click",function(e){"popover"!==$(e.target).data("toggle")&&0===$(e.target).parents(".popover.in").length&&$(s).popover("hide")})}}]).directive("fileread",[function(){return{scope:{fileread:"="},link:function(e,s,t){s.bind("change",function(s){var t=new FileReader;t.onload=function(s){e.$apply(function(){e.fileread=s.target.result})},t.readAsText(s.target.files[0])})}}}])}(),function(){function e(e,s,t,r,n,o,a){function c(){s.FetchHeight().then(function(e){void 0!==e.success&&e.success&&(l.height=e.data)})}var l=this;l.login=function(){NProgress.start(),s.CheckAccount(l.username,l.password).then(function(s){void 0!==s.success&&s.success&&void 0!=s.data?(r.set("credentials",{user:l.username,password:l.password}),setTimeout(function(){return NProgress.done()},500),e.path("/home")):(setTimeout(function(){return NProgress.done()},1e3),o("MESSAGES.LOGIN_WRONG_CREDENTIALS").then(function(e){return t.Error(e)}),a.scrollTo(0,0))}).catch(function(){setTimeout(function(){return NProgress.done()},500),o("MESSAGES.GENERAL_CONNECTION_ERROR").then(function(e){return t.Error(e)}),a.scrollTo(0,0)})},r.remove("credentials"),l.changeLang=function(e){return o.use(e).then(function(e){return r.set("language",e)}).catch(function(e){return console.log("Cannot change language.")})},l.height="",c(),n(function(){return c()},1e4)}angular.module("app").controller("LoginController",e),e.$inject=["$location","MetaverseService","FlashService","localStorageService","$interval","$translate","$window"]}(),function(){function e(e,s){function t(s,t){return e.post(c,{method:s,params:t},{headers:{}}).then(function(e){return o.debug&&console.log({method:s,params:t,result:e.data}),r(e)},function(e){n(e)})}function r(e){return void 0!=e.data&&void 0==e.data.error?{success:!0,data:e.data}:n(e)}function n(e){return void 0!=e.data&&void 0!=e.data.error?{success:!1,message:e.data.error}:{success:!1,message:"General connection error"}}var o={},a=window.location.hostname+":8820",c="http://"+a+"/rpc";return o.debug=!1,o.CheckAccount=function(e,s){return t("getbalance",[e,s])},o.GetNewAccount=function(e,s){return t("getnewaccount",[e,s])},o.ImportAccount=function(e,s,r,n){return t("importaccount",["-n",e,"-p",s,"-i",n,r])},o.GetBalance=function(){var e=s.get("credentials");return t("getbalance",[e.user,e.password])},o.ListAddresses=function(){var e=s.get("credentials");return t("listaddresses",[e.user,e.password])},o.ListBalances=function(e){var r=s.get("credentials");return e?t("listbalances",["-n",r.user,r.password]):t("listbalances",[r.user,r.password])},o.GetAccount=function(e){var r=s.get("credentials");return t("getaccount",[r.user,r.password,e])},o.GetNewAddress=function(){var e=s.get("credentials");return t("getnewaddress",[e.user,e.password])},o.ChangePassword=function(e){var r=s.get("credentials");return t("changepasswd",[r.user,r.password,"--password",e])},o.ResetPassword=function(e,s,r){return t("changepasswdext",["-n",e,"-p",s,r])},o.ExportAccountAsFile=function(e,r,n){return t("exportaccountasfile",[s.get("credentials").user,e,r,n])},o.ImportAccountFromFile=function(e,s){return t("importaccountfromfile",[e,s])},o.SERVER=a,o.Start=function(){var e=s.get("credentials");return t("start",[e.user,e.password])},o.Stop=function(){var e=s.get("credentials");return t("stop",[e.user,e.password])},o.GetMiningInfo=function(){var e=s.get("credentials");return t("getmininginfo",[e.user,e.password])},o.Send=function(e,r,n,o){var a=s.get("credentials");return""==o?t("send",[a.user,a.password,e,r,"-f",n]):t("send",[a.user,a.password,e,r,"-f",n,"-m",o])},o.SendFrom=function(e,r,n,o,a){var c=s.get("credentials");return""==a?t("sendfrom",[c.user,c.password,e,r,n,"-f",o]):t("sendfrom",[c.user,c.password,e,r,n,"-f",o,"-m",a])},o.SendMore=function(e,r){var n=s.get("credentials"),o=[],a="";return o.push(n.user),o.push(n.password),o.push("-f"),o.push(r),e.forEach(function(e){a=e.address+":"+e.value,o.push("-r"),o.push(a)}),t("sendmore",o)},o.ListTxs=function(e){var r=s.get("credentials");return t("listtxs",["-i",e,r.user,r.password])},o.GetPublicKey=function(e){var r=s.get("credentials");return t("getpublickey",[r.user,r.password,e])},o.GetNewMultiSig=function(e,r,n,o){var a=s.get("credentials"),c=[];return c.push("-m"),c.push(e),c.push("-n"),c.push(r),c.push("-s"),c.push(n),o.forEach(function(e){c.push("-k"),c.push(e.publicKey)}),c.push(a.user),c.push(a.password),t("getnewmultisig",c)},o.ListMultiSig=function(){var e=s.get("credentials");return t("listmultisig",[e.user,e.password])},o.CreateMultisigTx=function(e,r,n,o){var a=s.get("credentials");return t("createmultisigtx",[a.user,a.password,e,r,n,"-f",o])},o.SignMultisigTx=function(e,r){var n=s.get("credentials");return r?t("signmultisigtx",[n.user,n.password,e,"-b"]):t("signmultisigtx",[n.user,n.password,e])},o.CreateAsset=function(e,r,n,o,a){r*=Math.pow(10,o);var c=s.get("credentials");return t("createasset",[c.user,c.password,"-s",e,"-v",r,"-n",o,"-d",a])},o.ListAssets=function(){var e=s.get("credentials");return t("listassets",[e.user,e.password])},o.ListAllAssets=function(){return t("listassets")},o.GetAsset=function(e){var r=s.get("credentials");return t("getasset",[r.user,r.password,e])},o.GetAddressAsset=function(e){return t("getaddressasset",[e])},o.SendAssetFrom=function(e,r,n,o){var a=s.get("credentials");return t("sendassetfrom",[a.user,a.password,e,r,n,o])},o.SendAsset=function(e,r,n){var o=s.get("credentials");return t("sendasset",[o.user,o.password,e,r,n])},o.Issue=function(e){var r=s.get("credentials");return t("issue",[r.user,r.password,e])},o.SecondIssue=function(e,r){var n=s.get("credentials");return t("secondissue",[n.user,n.password,e,r])},o.Delete=function(e){var r=s.get("credentials");return t("deleteunissuedasset",["-s",e,r.user,r.password])},o.FetchHeight=function(){return t("fetch-height",[])},o.FetchTx=function(e){return t("fetch-tx",[e])},o.FetchHeader=function(e){return t("fetch-header",["-t",e])},o.GetBlock=function(e){return t("getblock",[e,"--json=true"])},o.ListTxsAddress=function(e,r){var n=s.get("credentials");return t("listtxs",[n.user,n.password,"-a",e,"-i",r])},o.Query=function(e){var s=e,r=[];return e.indexOf(" ")>=0&&(s=e.split(" ")[0],r=e.substring(e.indexOf(s)+s.length+1).replace(/\s{2,}/g," ").split(" ")),t(s,r)},o.Deposit=function(e,r,n,o,a){var c=s.get("credentials");return void 0!=a?t("deposit",["-d",e,"-a",a,"-f",n,c.user,o,r]):t("deposit",["-d",e,"-f",n,c.user,o,r])},o.FrozenAsset=function(e,r,n,o,a){var c=s.get("credentials");return e*=86400,void 0!=a?t("frozenasset",["-d",a,c.user,n,o,r,e]):t("frozenasset",[c.user,n,o,r,e])},o}function s(e,s){function t(e){if(void 0!=e.outputs&&Array.isArray(e.outputs)){var s;return e.outputs.forEach(function(e){"asset-transfer"===e.attachment.type&&(s=o),"asset-issue"===e.attachment.type&&(s=a)}),s||n}return c}var r={},n="ETP",o="ASSET",a="ISSUE",c="UNKNOWN";return r.LoadTransactions=function(r,c,l){e.ListTxs(l).then(function(e){var c=[];"undefined"!==e.success&&e.success?(e.data.current_page==e.data.total_page?c.lastpage=!0:c.lastpage=!1,void 0==e.data.transactions?(console.log("unable to load transactions."),r(1)):e.data.transactions.length>0?(e.data.transactions.forEach(function(e){var s={height:e.height,hash:e.hash,timestamp:new Date(1e3*e.timestamp),direction:e.direction,recipents:[],value:0};switch(t(e)){case n:s.type="ETP",s.asset_type=8,e.outputs.forEach(function(e){void 0!==e.script&&null!=e.script.match(/\[ (\w+) ] numequalverify dup hash160 \[ (\w+) \] equalverify checksig/)?(s.frozen=!0,s.recipents.push({address:e.address,value:parseInt(e["etp-value"]),script:e.script}),s.value+=parseInt(e["etp-value"])):("receive"===s.direction&&"true"===e.own||"send"===s.direction&&"false"===e.own)&&(s.frozen=!1,s.recipents.push({address:e.address,value:parseInt(e["etp-value"]),script:e.script}),s.value+=parseInt(e["etp-value"]))}),s.value&&c.push(s);break;case o:e.outputs.forEach(function(e){("receive"===s.direction&&"true"===e.own||"send"===s.direction&&"false"===e.own&&"asset-transfer"===e.attachment.type)&&(s.recipents.push({address:e.address,value:parseInt(e.attachment.quantity)}),s.value+=parseInt(e.attachment.quantity),s.type=e.attachment.symbol,s.decimal_number=e.attachment.decimal_number)}),s.value&&c.push(s);break;case a:s.direction="issue",e.outputs.forEach(function(e){"true"===e.own&&"asset-issue"===e.attachment.type&&(s.recipents.push({address:e.address,value:parseInt(e.attachment.maximum_supply)}),s.value+=parseInt(e.attachment.maximum_supply),s.type=e.attachment.symbol,s.decimal_number=e.attachment.decimal_number)}),s.value&&c.push(s)}}),r(null,c)):r(null,[])):(e.error="no record in this page")?r(null,[]):s("MESSAGES.TRANSACTIONS_LOAD_ERROR").then(function(e){r(1,null,e)})})},r.GetBalance=function(t){e.GetBalance().then(function(e){void 0!==e.success&&e.success?s("MESSAGES.GENERAL_CONNECTION_ERROR").then(function(s){t(null,e.data,s)}):s("MESSAGES.GENERAL_CONNECTION_ERROR").then(function(e){t(1,null,e)})})},r}angular.module("app").factory("MetaverseService",e).factory("MetaverseHelperService",s),e.$inject=["$http","localStorageService"],s.$inject=["MetaverseService","$translate"]}(),function(){function e(e,s,t,r,n,o,a,c,l){function i(){e.FetchHeight().then(function(e){void 0!==e.success&&e.success&&(u.height=e.data)})}var u=this;u.register=function(){if(NProgress.start(),setTimeout(function(){return NProgress.done()},500),!(void 0!=u.user.username&&""!=u.user.username||s.import_from_file))return c("MESSAGES.NO_ACCOUNTNAME_PROVIDED").then(function(e){return a.Error(e)}),void l.scrollTo(0,0);if(void 0==u.user.password)return c("MESSAGES.NO_PASSWORD_PROVIDED").then(function(e){return a.Error(e)}),void l.scrollTo(0,0);if(u.user.password.length<6)return c("MESSAGES.PASSWORD_SHORT").then(function(e){return a.Error(e)}),void l.scrollTo(0,0);if(u.user.password_repeat!=u.user.password&&!s.import_from_file&&!s.import_from_phrase)return c("MESSAGES.PASSWORD_NOT_MATCH").then(function(e){return a.Error(e)}),void l.scrollTo(0,0);if(s.import_from_phrase){var t=/(\r\n|\n|\r)/gm,n=s.import_phrase.replace(t," "),o=(n=n.replace("  "," ")).match(/[a-z]|[A-Z]| /g);if(n.length!=o.length)return c("MESSAGE.WRONG_PRIVATE_KEY").then(function(e){return a.Error(e)}),void l.scrollTo(0,0);e.ImportAccount(u.user.username,u.user.password,n,s.address_count).then(function(e){void 0!==e.success&&e.success?c("MESSAGES.IMPORT_SUCCESS").then(function(e){a.Success(e,!0),l.scrollTo(0,0),r.path("/login")}):c("MESSAGES.IMPORT_ERROR").then(function(s){void 0!=e.message?(a.Error(s+" "+e.message),l.scrollTo(0,0)):(a.Error(s),l.scrollTo(0,0))})})}else s.import_from_file?e.ImportAccountFromFile(s.path,u.user.password).then(function(e){void 0!==e.success&&e.success?c("MESSAGES.IMPORT_SUCCESS").then(function(e){a.Success(e,!0),r.path("/login")}):c("MESSAGES.IMPORT_ERROR").then(function(s){void 0!=e.message?(a.Error(s+" "+e.message),l.scrollTo(0,0)):(a.Error(s),l.scrollTo(0,0))})}):e.GetNewAccount(u.user.username,u.user.password).then(function(e){void 0!==e.success&&e.success?(c("MESSAGES.REGISTARTION_SUCCESS").then(function(e){return a.Success(e)}),l.scrollTo(0,0),u.registered={privatekey:e.data.mnemonic,address:e.data["default-address"]}):(a.Error(e.message),l.scrollTo(0,0))})},u.user={username:""},u.changeLang=function(e){return c.use(e).then(function(e){return n.set("language",e)}).catch(function(e){return console.log("Cannot change language.")})},u.height="",i(),t(function(){return i()},1e4)}angular.module("app").controller("RegisterController",e),e.$inject=["MetaverseService","$scope","$interval","$location","localStorageService","$rootScope","FlashService","$translate","$window"]}();